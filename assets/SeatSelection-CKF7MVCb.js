import{r as e,j as s,u as a,w as n,m as t,o as i,L as c}from"./index-BZly9VVj.js";const l={seat:"_seat_toh6b_7",seatBack:"_seatBack_toh6b_63",seatCushion:"_seatCushion_toh6b_83",seatLabel:"_seatLabel_toh6b_121",selected:"_selected_toh6b_139",checkmark:"_checkmark_toh6b_166",occupied:"_occupied_toh6b_204",occupiedIcon:"_occupiedIcon_toh6b_218",emergencyRow:"_emergencyRow_toh6b_245",maxReached:"_maxReached_toh6b_262"},r=e.memo(({seatId:e,isOccupied:a=!1,isSelected:n=!1,isEmergencyRow:t=!1,onSelect:i,onKeyDown:c,disabled:r=!1})=>{const o=[l.seat,a&&l.occupied,n&&l.selected,t&&l.emergencyRow,r&&!a&&l.maxReached].filter(Boolean).join(" ");return s.jsxs("button",{type:"button",className:o,onClick:i,onKeyDown:c,disabled:a,"aria-label":(()=>{const s=`Seat ${e}`;return a?`${s}, unavailable`:n?`${s}, selected`:t?`${s}, emergency exit row`:`${s}, available`})(),"aria-pressed":n,role:"checkbox","aria-checked":n,tabIndex:a?-1:0,children:[s.jsx("span",{className:l.seatBack,"aria-hidden":"true"}),s.jsx("span",{className:l.seatCushion,"aria-hidden":"true",children:a?s.jsxs("svg",{className:l.occupiedIcon,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("circle",{cx:"12",cy:"8",r:"4"}),s.jsx("path",{d:"M12 14c-4 0-8 2-8 4v2h16v-2c0-2-4-4-8-4z"})]}):s.jsx("span",{className:l.seatLabel,children:e})}),n&&s.jsx("span",{className:l.checkmark,"aria-hidden":"true",children:s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:s.jsx("polyline",{points:"20,6 9,17 4,12"})})})]})});r.displayName="Seat";const o="_seatMapWrapper_1tx78_58",d="_busFrame_1tx78_65",h="_busFront_1tx78_96",_="_frontWindow_1tx78_102",x="_windowGlare_1tx78_111",m="_frontDetails_1tx78_132",u="_driverArea_1tx78_139",j="_steeringWheel_1tx78_150",p="_driverLabel_1tx78_167",g="_doorIndicator_1tx78_175",v="_seatGrid_1tx78_200",w="_seatRow_1tx78_207",k="_backRow_1tx78_225",N="_rowLabel_1tx78_231",b="_leftSection_1tx78_241",y="_rightSection_1tx78_242",S="_aisle_1tx78_247",f="_emergencyRow_1tx78_277",R="_emergencySpacer_1tx78_313",C="_busRear_1tx78_352",B="_rearWindow_1tx78_357",L="_selectionSummary_1tx78_382",$="_selectedSeatsChips_1tx78_402",W="_seatChip_1tx78_409",E="_removeSeat_1tx78_434",I="_summaryTotal_1tx78_456",M="_totalPrice_1tx78_470",P={rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5},O=({config:a=P,selectedSeats:n=[],occupiedSeats:t=[],onSeatToggle:i,maxSelectable:c=4,pricePerSeat:l=0,currency:O="BWP"})=>{const{rows:D,seatsPerRow:T,aisleAfter:A,emergencyExitRows:K,hasBackRow:G,backRowSeats:z}={...P,...a},F=e.useMemo(()=>{const e=[];for(let s=1;s<=D;s++){const a=[],i=G&&s===D?z:T;for(let e=1;e<=i;e++){const i=`${s}${String.fromCharCode(64+e)}`;a.push({id:i,row:s,col:e,isOccupied:t.includes(i),isSelected:n.includes(i),isEmergencyRow:K.includes(s)})}e.push({rowNumber:s,seats:a,isEmergencyRow:K.includes(s),isBackRow:G&&s===D})}return e},[D,T,G,z,t,n,K]),H=e.useCallback(e=>{if(t.includes(e))return;!n.includes(e)&&n.length>=c||null==i||i(e)},[t,n,c,i]),U=e.useCallback((e,s)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),H(s))},[H]);return s.jsxs("div",{className:o,children:[s.jsxs("div",{className:d,children:[s.jsxs("div",{className:h,children:[s.jsx("div",{className:_,children:s.jsx("div",{className:x})}),s.jsxs("div",{className:m,children:[s.jsxs("div",{className:g,children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("rect",{x:"3",y:"2",width:"18",height:"20",rx:"2"}),s.jsx("path",{d:"M12 2v20"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor"})]}),s.jsx("span",{children:"Entry"})]}),s.jsxs("div",{className:u,children:[s.jsx("div",{className:j,children:s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("circle",{cx:"12",cy:"12",r:"9"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 3v6M12 15v6M3 12h6M15 12h6"})]})}),s.jsx("span",{className:p,children:"Driver"})]})]})]}),s.jsx("div",{className:v,role:"group","aria-label":"Bus seat selection",children:F.map(({rowNumber:e,seats:a,isEmergencyRow:t,isBackRow:i})=>{const l=a.slice(0,i?Math.ceil(z/2):A),o=a.slice(i?Math.ceil(z/2):A),d=t&&!i&&a.length>=4,h=d&&l.length>0?[l[0]]:[],_=d&&l.length>1?l.slice(1):l,x=d&&o.length>1?o.slice(0,-1):o,m=d&&o.length>0?[o[o.length-1]]:[];return s.jsxs("div",{className:`${w} ${i?k:""} ${t?f:""}`,role:"row","aria-label":`Row ${e}${t?", emergency exit row":""}`,children:[s.jsx("span",{className:N,children:e}),s.jsxs("div",{className:b,children:[h.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>H(e.id),onKeyDown:s=>U(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=c},e.id)),d&&h.length>0&&_.length>0&&s.jsx("div",{className:R,"aria-hidden":"true"}),_.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>H(e.id),onKeyDown:s=>U(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=c},e.id))]}),!i&&s.jsx("div",{className:S,"aria-hidden":"true"}),s.jsxs("div",{className:y,children:[x.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>H(e.id),onKeyDown:s=>U(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=c},e.id)),d&&x.length>0&&m.length>0&&s.jsx("div",{className:R,"aria-hidden":"true"}),m.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>H(e.id),onKeyDown:s=>U(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=c},e.id))]}),s.jsx("span",{className:N,children:e})]},e)})}),s.jsx("div",{className:C,children:s.jsx("div",{className:B})})]}),n.length>0&&s.jsxs("div",{className:L,children:[s.jsx("div",{className:$,children:n.map(e=>s.jsxs("span",{className:W,children:[e,s.jsx("button",{type:"button",className:E,onClick:()=>H(e),"aria-label":`Remove seat ${e}`,children:"×"})]},e))}),s.jsxs("div",{className:I,children:[s.jsxs("span",{children:[n.length," seat",1!==n.length?"s":""]}),s.jsxs("span",{className:M,children:[O," ",(n.length*l).toLocaleString()]})]})]})]})},D="_seatSelectionPage_a5nms_33",T="_header_a5nms_47",A="_backBtn_a5nms_59",K="_headerContent_a5nms_84",G="_title_a5nms_89",z="_subtitle_a5nms_97",F="_routeCard_a5nms_107",H="_routeInfo_a5nms_115",U="_origin_a5nms_123",Y="_destination_a5nms_124",q="_arrow_a5nms_131",J="_tripMeta_a5nms_148",Q="_metaItem_a5nms_156",V="_passengerSelector_a5nms_175",X="_passengerLabel_a5nms_184",Z="_passengerControls_a5nms_200",ee="_passengerBtn_a5nms_207",se="_passengerInput_a5nms_244",ae="_legend_a5nms_280",ne="_legendItem_a5nms_293",te="_legendBox_a5nms_299",ie="_available_a5nms_309",ce="_selected_a5nms_314",le="_taken_a5nms_327",re="_mainContent_a5nms_352",oe="_footer_a5nms_361",de="_priceInfo_a5nms_377",he="_seatCount_a5nms_383",_e="_totalPrice_a5nms_388",xe="_continueBtn_a5nms_395",me=()=>{const l=a(),{tripId:r}=n(),[o,d]=t(),{selectedRoute:h,selectedSeats:_,setSelectedSeats:x}=i(),[m,u]=e.useState(!0),[j,p]=e.useState([]),g=parseInt(o.get("passengers")||"1"),[v,w]=e.useState(g);e.useEffect(()=>{const e=setTimeout(()=>{u(!1)},500);return()=>clearTimeout(e)},[]),e.useEffect(()=>{h||l("/home")},[h,l]),e.useEffect(()=>{if(o.get("passengers")!==v.toString()){const e=new URLSearchParams(o);e.set("passengers",v.toString()),d(e,{replace:!0})}},[v,o,d]),e.useEffect(()=>{_.length>v&&x(e=>e.slice(0,v))},[v,_.length,x]);const k=e=>{e>=1&&e<=10&&w(e)};if(m)return s.jsx("div",{className:D,children:s.jsx(c,{size:"large"})});if(!h)return null;const N=_.length*(h.price||0);return s.jsxs("div",{className:D,children:[s.jsxs("header",{className:T,children:[s.jsx("button",{type:"button",className:A,onClick:()=>l(-1),"aria-label":"Go back",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M19 12H5"}),s.jsx("polyline",{points:"12 19 5 12 12 5"})]})}),s.jsxs("div",{className:K,children:[s.jsx("h1",{className:G,children:"Select Your Seats"}),s.jsx("p",{className:z,children:0===_.length?`Select ${v} seat${v>1?"s":""} for ${v} passenger${v>1?"s":""}`:v-_.length>0?`${_.length} of ${v} seats selected`:"All seats selected"})]})]}),s.jsxs("div",{className:F,children:[s.jsxs("div",{className:H,children:[s.jsx("span",{className:U,children:h.origin}),s.jsx("div",{className:q,children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})}),s.jsx("span",{className:Y,children:h.destination})]}),s.jsxs("div",{className:J,children:[s.jsxs("div",{className:Q,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),s.jsx("span",{children:(b=h.date,b?new Date(b).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}):"")})]}),s.jsxs("div",{className:Q,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),s.jsx("span",{children:(e=>e?new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--")(h.departure_time)})]})]}),s.jsxs("div",{className:V,children:[s.jsxs("label",{className:X,children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),s.jsx("span",{children:"Number of Passengers"})]}),s.jsxs("div",{className:Z,children:[s.jsx("button",{type:"button",className:ee,onClick:()=>k(v-1),disabled:v<=1,"aria-label":"Decrease passengers",children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),s.jsx("input",{type:"number",min:"1",max:"10",value:v,onChange:e=>{const s=parseInt(e.target.value)||1;k(Math.max(1,Math.min(10,s)))},className:se,"aria-label":"Number of passengers"}),s.jsx("button",{type:"button",className:ee,onClick:()=>k(v+1),disabled:v>=10,"aria-label":"Increase passengers",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]})]}),s.jsxs("div",{className:ae,children:[s.jsxs("div",{className:ne,children:[s.jsx("div",{className:`${te} ${ie}`}),s.jsx("span",{children:"Available"})]}),s.jsxs("div",{className:ne,children:[s.jsx("div",{className:`${te} ${ce}`}),s.jsx("span",{children:"Selected"})]}),s.jsxs("div",{className:ne,children:[s.jsx("div",{className:`${te} ${le}`}),s.jsx("span",{children:"Taken"})]})]}),s.jsx("main",{className:re,children:s.jsx(O,{selectedSeats:_,occupiedSeats:j,onSeatToggle:e=>{x(s=>s.includes(e)?s.filter(s=>s!==e):s.length>=v?s:[...s,e])},maxSelectable:v,pricePerSeat:h.price||0,currency:"BWP",config:{rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5}})}),s.jsxs("div",{className:oe,children:[s.jsxs("div",{className:de,children:[s.jsx("span",{className:he,children:0===_.length?"No seats selected":`${_.length} seat${_.length>1?"s":""} × BWP ${(h.price||0).toLocaleString()}`}),s.jsx("span",{className:_e,children:0===_.length?"BWP 0":`BWP ${N.toLocaleString()}`})]}),s.jsxs("button",{type:"button",className:xe,onClick:()=>{0!==_.length?l("/booking/passenger-details"):alert("Please select at least one seat")},disabled:0===_.length,children:["Continue",s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]});var b};export{me as default};
