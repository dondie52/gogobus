import{r as e,j as l,u as a,k as s,a as n,o as t,L as i,p as r,c as o}from"./index-D2RF4Oxz.js";import{B as u}from"./Button-CG6pit9x.js";import{I as m}from"./Input-DO82tn-B.js";import{s as d}from"./Booking.module-Dh2teIrb.js";const c="_passengerForm_18zwr_1",h="_passengerTitle_18zwr_9",g="_formFields_18zwr_17",p=({seatNumber:a,index:s,defaultData:n,onChange:t})=>{const[i,r]=e.useState({fullName:(null==n?void 0:n.full_name)||"",email:(null==n?void 0:n.email)||"",phone:(null==n?void 0:n.phone)||"",idNumber:""});e.useEffect(()=>{t(i)},[i]);const o=(e,l)=>{r(a=>({...a,[e]:l}))};return l.jsxs("div",{className:c,children:[l.jsxs("h3",{className:h,children:["Passenger ",s+1," - Seat ",a]}),l.jsxs("div",{className:g,children:[l.jsx(m,{label:"Full Name",value:i.fullName,onChange:e=>o("fullName",e.target.value),placeholder:"Enter full name",required:!0}),l.jsx(m,{type:"email",label:"Email",value:i.email,onChange:e=>o("email",e.target.value),placeholder:"Enter email",required:!0}),l.jsx(m,{type:"tel",label:"Phone Number",value:i.phone,onChange:e=>o("phone",e.target.value),placeholder:"+26771234567",required:!0}),l.jsx(m,{label:"ID Number (Optional)",value:i.idNumber,onChange:e=>o("idNumber",e.target.value),placeholder:"Enter ID number"})]})]})},f=()=>{const m=a();s();const{user:c}=n(),{selectedRoute:h,selectedSeats:g,passengerDetails:f,setPassengerDetails:N}=t(),[v,j]=e.useState(null),[b,x]=e.useState(!0);e.useEffect(()=>{},[g,h]),e.useEffect(()=>{(async()=>{if(null==c?void 0:c.id)try{const e=await r.getProfile(c.id);j(e)}catch(e){o("Failed to load profile",e)}x(!1)})()},[c]),e.useEffect(()=>{g&&0!==g.length||m("/home")},[g,m]);return b?l.jsx("div",{className:d.loadingContainer,children:l.jsx(i,{size:"large"})}):l.jsxs("div",{className:d.bookingScreen,children:[l.jsxs("div",{className:d.bookingHeader,children:[l.jsx("button",{className:d.backButton,onClick:e=>{try{m("/home")}catch(l){}},children:"â† Back"}),l.jsx("h1",{children:"Passenger Details"})]}),l.jsxs("div",{className:d.bookingContent,children:[l.jsxs("p",{className:d.instruction,children:["Please provide details for ",g.length," passenger",1!==g.length?"s":""]}),g.map((e,a)=>l.jsx(p,{seatNumber:e,index:a,defaultData:v,onChange:e=>((e,l)=>{const a=[...f];a[e]={...a[e],...l},N(a)})(a,e)},e)),l.jsx("div",{className:d.bookingFooter,children:l.jsx(u,{onClick:()=>{let e=f;if(f.length!==g.length){const l=g.map((e,l)=>{const a=f[l]||{};return{seatNumber:e,fullName:a.fullName||(null==v?void 0:v.full_name)||"",email:a.email||(null==v?void 0:v.email)||(null==c?void 0:c.email)||"",phone:a.phone||(null==v?void 0:v.phone)||"",idNumber:a.idNumber||""}});N(l),e=l}if(e.length!==g.length)return void alert("Error: Passenger details count does not match selected seats. Please try again.");if(!e.every(e=>e&&e.fullName&&e.fullName.trim()&&e.email&&e.email.trim()&&e.phone&&e.phone.trim())){const l=e.map((e,l)=>{const a=[];return e.fullName||a.push("Full Name"),e.email||a.push("Email"),e.phone||a.push("Phone"),a.length>0?`Passenger ${l+1}: ${a.join(", ")}`:null}).filter(Boolean);return void alert(`Please fill in all required passenger details.\n\nMissing fields:\n${l.join("\n")}`)}m("/booking/summary")},children:"Continue"})})]})]})};export{f as default};
