import{j as e,u as a,m as t,a as s,r as i,L as c,q as n,c as l}from"./index-GPZqme8R.js";const r={ticketCard:"_ticketCard_1jltu_1",ticketHeader:"_ticketHeader_1jltu_16",companyInfo:"_companyInfo_1jltu_25",companyLogo:"_companyLogo_1jltu_31",companyName:"_companyName_1jltu_35",statusBadge:"_statusBadge_1jltu_42",confirmed:"_confirmed_1jltu_51",cancelled:"_cancelled_1jltu_56",pending:"_pending_1jltu_61",ticketRoute:"_ticketRoute_1jltu_66",routePoint:"_routePoint_1jltu_76",city:"_city_1jltu_83",time:"_time_1jltu_90",routeLine:"_routeLine_1jltu_96",arrow:"_arrow_1jltu_104",duration:"_duration_1jltu_110",ticketFooter:"_ticketFooter_1jltu_116",ticketDate:"_ticketDate_1jltu_124",ticketPrice:"_ticketPrice_1jltu_125",dateLabel:"_dateLabel_1jltu_131",priceLabel:"_priceLabel_1jltu_132",dateValue:"_dateValue_1jltu_138",priceValue:"_priceValue_1jltu_145"},o=({booking:a,onClick:t})=>{var s;const i=a.schedule||{},c=i.route||{},n=(i.bus||{}).company||{},l=e=>e||"";return e.jsxs("div",{className:r.ticketCard,onClick:t,children:[e.jsxs("div",{className:r.ticketHeader,children:[e.jsxs("div",{className:r.companyInfo,children:[e.jsx("span",{className:r.companyLogo,children:n.logo||"ðŸšŒ"}),e.jsx("span",{className:r.companyName,children:n.name||"Bus Company"})]}),e.jsx("div",{className:`${r.statusBadge} ${r[a.status]}`,children:a.status||"confirmed"})]}),e.jsxs("div",{className:r.ticketRoute,children:[e.jsxs("div",{className:r.routePoint,children:[e.jsx("span",{className:r.city,children:c.origin||"Origin"}),e.jsx("span",{className:r.time,children:l(i.departure_time)})]}),e.jsxs("div",{className:r.routeLine,children:[e.jsx("span",{className:r.arrow,children:"â†’"}),e.jsx("span",{className:r.duration,children:i.duration||"N/A"})]}),e.jsxs("div",{className:r.routePoint,children:[e.jsx("span",{className:r.city,children:c.destination||"Destination"}),e.jsx("span",{className:r.time,children:l(i.arrival_time)})]})]}),e.jsxs("div",{className:r.ticketFooter,children:[e.jsxs("div",{className:r.ticketDate,children:[e.jsx("span",{className:r.dateLabel,children:"Date"}),e.jsx("span",{className:r.dateValue,children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})(i.departure_time||a.created_at)})]}),e.jsxs("div",{className:r.ticketPrice,children:[e.jsx("span",{className:r.priceLabel,children:"Total"}),e.jsxs("span",{className:r.priceValue,children:["P",(null==(s=a.total_price)?void 0:s.toFixed(2))||"0.00"]})]})]})]})},d="_ticketTabs_16owj_1",_="_tab_16owj_9",u="_active_16owj_28",m=({activeTab:a,onTabChange:t})=>e.jsxs("div",{className:d,children:[e.jsx("button",{className:`${_} ${"upcoming"===a?u:""}`,onClick:()=>t("upcoming"),children:"Upcoming"}),e.jsx("button",{className:`${_} ${"past"===a?u:""}`,onClick:()=>t("past"),children:"Past"})]}),j="_myTicketsScreen_13s00_1",p="_myTicketsHeader_13s00_7",h="_loadingContainer_13s00_21",x="_errorMessage_13s00_28",N="_emptyState_13s00_37",k="_emptyIcon_13s00_46",g="_ticketsList_13s00_64",v=()=>{const r=a(),[d,_]=t(),{user:u}=s(),[v,y]=i.useState([]),[b,L]=i.useState(!0),[f,w]=i.useState(()=>"past"===d.get("tab")?"past":"upcoming"),[C,D]=i.useState("");i.useEffect(()=>{(async()=>{if(null==u?void 0:u.id){L(!0);try{const e=await n.getUserBookings(u.id);y(e)}catch(e){l("Failed to load bookings",e),D("Failed to load tickets. Please try again.")}finally{L(!1)}}})()},[u]);const P=v.filter(e=>{var a,t;if("upcoming"===f){return new Date((null==(a=e.schedule)?void 0:a.departure_time)||e.created_at)>=new Date&&"cancelled"!==e.status}return new Date((null==(t=e.schedule)?void 0:t.departure_time)||e.created_at)<new Date||"cancelled"===e.status});return b?e.jsx("div",{className:h,children:e.jsx(c,{size:"large"})}):e.jsxs("div",{className:j,children:[e.jsx("div",{className:p,children:e.jsx("h1",{children:"My Tickets"})}),e.jsx(m,{activeTab:f,onTabChange:e=>{w(e);const a=new URLSearchParams(d);"past"===e?a.set("tab","past"):a.delete("tab"),_(a,{replace:!0})}}),C?e.jsx("div",{className:x,children:C}):0===P.length?e.jsxs("div",{className:N,children:[e.jsx("div",{className:k,children:"ðŸŽ«"}),e.jsxs("h3",{children:["No ","upcoming"===f?"upcoming":"past"," tickets"]}),e.jsx("p",{children:"upcoming"===f?"You don't have any upcoming trips":"You don't have any past trips"})]}):e.jsx("div",{className:g,children:P.map(a=>e.jsx(o,{booking:a,onClick:()=>{return e=a.id,void r(`/tickets/${e}`);var e}},a.id))})]})};export{v as default};
