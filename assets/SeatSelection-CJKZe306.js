import{r as e,j as s,u as a,w as n,m as t,o as i,L as l}from"./index-gc_mrg1P.js";const o={seat:"_seat_toh6b_7",seatBack:"_seatBack_toh6b_63",seatCushion:"_seatCushion_toh6b_83",seatLabel:"_seatLabel_toh6b_121",selected:"_selected_toh6b_139",checkmark:"_checkmark_toh6b_166",occupied:"_occupied_toh6b_204",occupiedIcon:"_occupiedIcon_toh6b_218",emergencyRow:"_emergencyRow_toh6b_245",maxReached:"_maxReached_toh6b_262"},r=e.memo(({seatId:e,isOccupied:a=!1,isSelected:n=!1,isEmergencyRow:t=!1,onSelect:i,onKeyDown:l,disabled:r=!1})=>{const c=[o.seat,a&&o.occupied,n&&o.selected,t&&o.emergencyRow,r&&!a&&o.maxReached].filter(Boolean).join(" ");return s.jsxs("button",{type:"button",className:c,onClick:i,onKeyDown:l,disabled:a,"aria-label":(()=>{const s=`Seat ${e}`;return a?`${s}, unavailable`:n?`${s}, selected`:t?`${s}, emergency exit row`:`${s}, available`})(),"aria-pressed":n,role:"checkbox","aria-checked":n,tabIndex:a?-1:0,children:[s.jsx("span",{className:o.seatBack,"aria-hidden":"true"}),s.jsx("span",{className:o.seatCushion,"aria-hidden":"true",children:a?s.jsxs("svg",{className:o.occupiedIcon,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("circle",{cx:"12",cy:"8",r:"4"}),s.jsx("path",{d:"M12 14c-4 0-8 2-8 4v2h16v-2c0-2-4-4-8-4z"})]}):s.jsx("span",{className:o.seatLabel,children:e})}),n&&s.jsx("span",{className:o.checkmark,"aria-hidden":"true",children:s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:s.jsx("polyline",{points:"20,6 9,17 4,12"})})})]})});r.displayName="Seat";const c="_seatMapWrapper_lo2ox_58",d="_busFrame_lo2ox_65",h="_busFront_lo2ox_96",_="_frontWindow_lo2ox_102",x="_windowGlare_lo2ox_111",m="_frontDetails_lo2ox_132",u="_driverArea_lo2ox_139",j="_steeringWheel_lo2ox_150",p="_driverLabel_lo2ox_167",g="_doorIndicator_lo2ox_175",v="_seatGrid_lo2ox_200",k="_seatRow_lo2ox_208",w="_backRow_lo2ox_228",b="_rowLabel_lo2ox_234",N="_emergencyRowLabel_lo2ox_244",y="_tooltipVisible_lo2ox_336",S="_leftSection_lo2ox_343",f="_rightSection_lo2ox_344",C="_aisle_lo2ox_349",R="_emergencyRow_lo2ox_244",$="_busRear_lo2ox_473",B="_rearWindow_lo2ox_478",L="_selectionSummary_lo2ox_503",E="_selectedSeatsChips_lo2ox_523",W="_seatChip_lo2ox_530",M="_removeSeat_lo2ox_555",P="_summaryTotal_lo2ox_577",I="_totalPrice_lo2ox_591",T={rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5},D=({config:a=T,selectedSeats:n=[],occupiedSeats:t=[],onSeatToggle:i,maxSelectable:l=4,pricePerSeat:o=0,currency:D="BWP"})=>{const{rows:O,seatsPerRow:A,aisleAfter:K,emergencyExitRows:G,hasBackRow:z,backRowSeats:F}={...T,...a},H=e.useMemo(()=>{const e=[];for(let s=1;s<=O;s++){const a=[],i=z&&s===O?F:A;for(let e=1;e<=i;e++){const i=`${s}${String.fromCharCode(64+e)}`;a.push({id:i,row:s,col:e,isOccupied:t.includes(i),isSelected:n.includes(i),isEmergencyRow:G.includes(s)})}e.push({rowNumber:s,seats:a,isEmergencyRow:G.includes(s),isBackRow:z&&s===O})}return e},[O,A,z,F,t,n,G]),U=e.useCallback(e=>{if(t.includes(e))return;!n.includes(e)&&n.length>=l||null==i||i(e)},[t,n,l,i]),V=e.useCallback((e,s)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),U(s))},[U]),[Y,q]=e.useState(null),J=e.useCallback((e,s)=>{e.preventDefault(),e.stopPropagation(),q(s),setTimeout(()=>{q(null)},3e3)},[]),Q=e.useCallback(e=>{e.stopPropagation()},[]),X=e.useCallback((e,s)=>{e.stopPropagation(),Y===s?q(null):(q(s),setTimeout(()=>{q(null)},3e3))},[Y]);return s.jsxs("div",{className:c,children:[s.jsxs("div",{className:d,children:[s.jsxs("div",{className:h,children:[s.jsx("div",{className:_,children:s.jsx("div",{className:x})}),s.jsxs("div",{className:m,children:[s.jsxs("div",{className:g,children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("rect",{x:"3",y:"2",width:"18",height:"20",rx:"2"}),s.jsx("path",{d:"M12 2v20"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor"})]}),s.jsx("span",{children:"Entry"})]}),s.jsxs("div",{className:u,children:[s.jsx("div",{className:j,children:s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("circle",{cx:"12",cy:"12",r:"9"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 3v6M12 15v6M3 12h6M15 12h6"})]})}),s.jsx("span",{className:p,children:"Driver"})]})]})]}),s.jsx("div",{className:v,role:"group","aria-label":"Bus seat selection",children:H.map(({rowNumber:e,seats:a,isEmergencyRow:t,isBackRow:i})=>{const o=a.slice(0,i?Math.ceil(F/2):K),c=a.slice(i?Math.ceil(F/2):K);return s.jsxs("div",{className:`${k} ${i?w:""} ${t?R:""}`,role:"row","aria-label":`Row ${e}${t?", emergency exit row":""}`,children:[s.jsx("span",{className:`${b} ${t?N:""} ${t&&Y===e?y:""}`,title:t?"Emergency exit":void 0,"data-tooltip":t?"Emergency exit":void 0,onTouchStart:t?s=>J(s,e):void 0,onTouchEnd:t?Q:void 0,children:e}),s.jsx("div",{className:S,children:o.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>U(e.id),onKeyDown:s=>V(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=l},e.id))}),!i&&s.jsx("div",{className:C,"aria-hidden":"true"}),s.jsx("div",{className:f,children:c.map(e=>s.jsx(r,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>U(e.id),onKeyDown:s=>V(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=l},e.id))}),s.jsx("span",{className:`${b} ${t?N:""} ${t&&Y===e?y:""}`,title:t?"Emergency exit":void 0,"data-tooltip":t?"Emergency exit":void 0,onTouchStart:t?s=>J(s,e):void 0,onTouchEnd:t?Q:void 0,onClick:t?s=>X(s,e):void 0,children:e})]},e)})}),s.jsx("div",{className:$,children:s.jsx("div",{className:B})})]}),n.length>0&&s.jsxs("div",{className:L,children:[s.jsx("div",{className:E,children:n.map(e=>s.jsxs("span",{className:W,children:[e,s.jsx("button",{type:"button",className:M,onClick:()=>U(e),"aria-label":`Remove seat ${e}`,children:"×"})]},e))}),s.jsxs("div",{className:P,children:[s.jsxs("span",{children:[n.length," seat",1!==n.length?"s":""]}),s.jsxs("span",{className:I,children:[D," ",(n.length*o).toLocaleString()]})]})]})]})},O="_seatSelectionPage_a5nms_33",A="_header_a5nms_47",K="_backBtn_a5nms_59",G="_headerContent_a5nms_84",z="_title_a5nms_89",F="_subtitle_a5nms_97",H="_routeCard_a5nms_107",U="_routeInfo_a5nms_115",V="_origin_a5nms_123",Y="_destination_a5nms_124",q="_arrow_a5nms_131",J="_tripMeta_a5nms_148",Q="_metaItem_a5nms_156",X="_passengerSelector_a5nms_175",Z="_passengerLabel_a5nms_184",ee="_passengerControls_a5nms_200",se="_passengerBtn_a5nms_207",ae="_passengerInput_a5nms_244",ne="_legend_a5nms_280",te="_legendItem_a5nms_293",ie="_legendBox_a5nms_299",le="_available_a5nms_309",oe="_selected_a5nms_314",re="_taken_a5nms_327",ce="_mainContent_a5nms_352",de="_footer_a5nms_361",he="_priceInfo_a5nms_377",_e="_seatCount_a5nms_383",xe="_totalPrice_a5nms_388",me="_continueBtn_a5nms_395",ue=()=>{const o=a(),{tripId:r}=n(),[c,d]=t(),{selectedRoute:h,selectedSeats:_,setSelectedSeats:x}=i(),[m,u]=e.useState(!0),[j,p]=e.useState([]),g=parseInt(c.get("passengers")||"1"),[v,k]=e.useState(g);e.useEffect(()=>{const e=setTimeout(()=>{u(!1)},500);return()=>clearTimeout(e)},[]),e.useEffect(()=>{h||o("/home")},[h,o]),e.useEffect(()=>{if(c.get("passengers")!==v.toString()){const e=new URLSearchParams(c);e.set("passengers",v.toString()),d(e,{replace:!0})}},[v,c,d]),e.useEffect(()=>{_.length>v&&x(e=>e.slice(0,v))},[v,_.length,x]);const w=e=>{e>=1&&e<=10&&k(e)};if(m)return s.jsx("div",{className:O,children:s.jsx(l,{size:"large"})});if(!h)return null;const b=_.length*(h.price||0);return s.jsxs("div",{className:O,children:[s.jsxs("header",{className:A,children:[s.jsx("button",{type:"button",className:K,onClick:()=>o(-1),"aria-label":"Go back",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M19 12H5"}),s.jsx("polyline",{points:"12 19 5 12 12 5"})]})}),s.jsxs("div",{className:G,children:[s.jsx("h1",{className:z,children:"Select Your Seats"}),s.jsx("p",{className:F,children:0===_.length?`Select ${v} seat${v>1?"s":""} for ${v} passenger${v>1?"s":""}`:v-_.length>0?`${_.length} of ${v} seats selected`:"All seats selected"})]})]}),s.jsxs("div",{className:H,children:[s.jsxs("div",{className:U,children:[s.jsx("span",{className:V,children:h.origin}),s.jsx("div",{className:q,children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})}),s.jsx("span",{className:Y,children:h.destination})]}),s.jsxs("div",{className:J,children:[s.jsxs("div",{className:Q,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),s.jsx("span",{children:(N=h.date,N?new Date(N).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}):"")})]}),s.jsxs("div",{className:Q,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),s.jsx("span",{children:(e=>e?new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--")(h.departure_time)})]})]}),s.jsxs("div",{className:X,children:[s.jsxs("label",{className:Z,children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),s.jsx("span",{children:"Number of Passengers"})]}),s.jsxs("div",{className:ee,children:[s.jsx("button",{type:"button",className:se,onClick:()=>w(v-1),disabled:v<=1,"aria-label":"Decrease passengers",children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),s.jsx("input",{type:"number",min:"1",max:"10",value:v,onChange:e=>{const s=parseInt(e.target.value)||1;w(Math.max(1,Math.min(10,s)))},className:ae,"aria-label":"Number of passengers"}),s.jsx("button",{type:"button",className:se,onClick:()=>w(v+1),disabled:v>=10,"aria-label":"Increase passengers",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]})]}),s.jsxs("div",{className:ne,children:[s.jsxs("div",{className:te,children:[s.jsx("div",{className:`${ie} ${le}`}),s.jsx("span",{children:"Available"})]}),s.jsxs("div",{className:te,children:[s.jsx("div",{className:`${ie} ${oe}`}),s.jsx("span",{children:"Selected"})]}),s.jsxs("div",{className:te,children:[s.jsx("div",{className:`${ie} ${re}`}),s.jsx("span",{children:"Taken"})]})]}),s.jsx("main",{className:ce,children:s.jsx(D,{selectedSeats:_,occupiedSeats:j,onSeatToggle:e=>{x(s=>s.includes(e)?s.filter(s=>s!==e):s.length>=v?s:[...s,e])},maxSelectable:v,pricePerSeat:h.price||0,currency:"BWP",config:{rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5}})}),s.jsxs("div",{className:de,children:[s.jsxs("div",{className:he,children:[s.jsx("span",{className:_e,children:0===_.length?"No seats selected":`${_.length} seat${_.length>1?"s":""} × BWP ${(h.price||0).toLocaleString()}`}),s.jsx("span",{className:xe,children:0===_.length?"BWP 0":`BWP ${b.toLocaleString()}`})]}),s.jsxs("button",{type:"button",className:me,onClick:()=>{0!==_.length?o("/booking/passenger-details"):alert("Please select at least one seat")},disabled:0===_.length,children:["Continue",s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]});var N};export{ue as default};
