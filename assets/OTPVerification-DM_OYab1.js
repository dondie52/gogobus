import{u as e,k as a,a as s,r as t,j as i,L as l}from"./index-Cteh5ezv.js";import{B as n}from"./Button-D7ec3YZm.js";import{I as r}from"./Input-BXj31bvm.js";import{s as o}from"./Auth.module-DvRfuExQ.js";const c=()=>{var c;const d=e(),h=a(),{verifyOTP:m,sendOTP:u}=s(),[p,f]=t.useState((null==(c=h.state)?void 0:c.email)||""),[g,j]=t.useState(""),[x,v]=t.useState(!1),[y,b]=t.useState(!1),[k,N]=t.useState("");t.useEffect(()=>{const e=new URLSearchParams(window.location.hash.substring(1)),a=e.get("access_token"),s=e.get("type");!a||"email"!==s&&"signup"!==s||(window.location.hash="",d("signup"===s?"/complete-profile":"/home",{replace:!0}))},[d]);return i.jsx("div",{className:o.authScreen,children:i.jsxs("div",{className:o.authContainer,children:[i.jsxs("div",{className:o.authHeader,children:[i.jsx("button",{className:o.backBtn,onClick:()=>d("/signup"),"aria-label":"Go back",children:i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),i.jsx("h1",{className:o.authTitle,children:"Verify Email"}),i.jsx("div",{className:o.headerSpacer})]}),i.jsxs("div",{className:o.otpInfo,children:[i.jsx("p",{children:"We've sent a verification code to:"}),i.jsx("p",{className:o.emailDisplay,children:p||"your email"}),i.jsx("p",{className:o.otpInstructions,children:"Please check your email and enter the 6-digit code below, or click the magic link in the email."})]}),i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),N(""),g.length<6)N("Please enter the 6-digit code");else{v(!0);try{await m(p,g),d("/complete-profile")}catch(a){N(a.message||"Invalid verification code. Please try again.")}finally{v(!1)}}},className:o.authForm,children:[k&&i.jsx("div",{className:o.errorMessage,children:k}),i.jsx(r,{type:"text",label:"Verification Code",value:g,onChange:e=>j(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",required:!0,maxLength:6}),i.jsx(n,{type:"submit",disabled:x||6!==g.length,className:o.submitButton,children:x?i.jsx(l,{size:"small"}):"Verify"}),i.jsx("button",{type:"button",onClick:async()=>{if(p){b(!0);try{await u(p),N(""),alert("Verification code sent! Please check your email.")}catch(e){N(e.message||"Failed to resend code. Please try again.")}finally{b(!1)}}else N("Email is required to resend code")},disabled:y,className:o.resendButton,children:y?"Sending...":"Didn't receive code? Resend"})]})]})})};export{c as default};
