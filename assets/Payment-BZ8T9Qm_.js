import{u as e,m as s,a as t,o as n,r as a,c as i,j as o,q as d,U as r}from"./index-gc_mrg1P.js";import{p as c}from"./paymentService-DLAIA3KX.js";import{L as l}from"./LiveTrackingCard-CisqxttN.js";import"./trackingService-C5HdIq3A.js";const h="_paymentPage_1031u_6",u="_header_1031u_13",m="_backBtn_1031u_25",p="_headerTitle_1031u_42",g="_secureIcon_1031u_49",y="_content_1031u_60",x="_tripSummary_1031u_68",v="_tripHeader_1031u_76",j="_tripRoute_1031u_86",f="_routePoint_1031u_92",_="_routeDot_1031u_100",b="_destination_1031u_108",k="_routeLine_1031u_113",w="_tripDetails_1031u_121",P="_tripDetail_1031u_121",I="_section_1031u_144",S="_trackingSection_1031u_148",N="_sectionTitle_1031u_153",T="_methodsList_1031u_162",C="_methodCard_1031u_168",O="_selected_1031u_185",M="_methodRadio_1031u_190",D="_methodIcon_1031u_208",B="_brandLogos_1031u_218",L="_providerLogo_1031u_230",R="_methodInfo_1031u_238",F="_methodName_1031u_243",J="_methodDesc_1031u_250",G="_methodFee_1031u_255",W="_priceCard_1031u_266",$="_priceRow_1031u_273",E="_total_1031u_282",A="_priceDivider_1031u_288",U="_securityBadge_1031u_296",V="_securityText_1031u_312",H="_errorMessage_1031u_330",z="_mockPaymentNotice_1031u_343",Z="_mockPaymentText_1031u_361",Y="_payButton_1031u_380",q="_spinner_1031u_413",K="_terms_1031u_424",Q=()=>o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),X=()=>o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",ry:"2"}),o.jsx("path",{d:"M9 22v-4h6v4"}),o.jsx("path",{d:"M8 6h.01M16 6h.01M12 6h.01M12 10h.01M12 14h.01M16 10h.01M16 14h.01M8 10h.01M8 14h.01"})]}),ee=()=>o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M20 6 9 17l-5-5"})}),se=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),o.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),te=()=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"m12 19-7-7 7-7"}),o.jsx("path",{d:"M19 12H5"})]}),ne=()=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M8 6v6m8-6v6M5 18v2m14-2v2M3 6h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6ZM3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2"}),o.jsx("circle",{cx:"7",cy:"15",r:"1"}),o.jsx("circle",{cx:"17",cy:"15",r:"1"})]}),ae=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),o.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),o.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),ie=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),oe=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"}),o.jsx("path",{d:"M13 5v2"}),o.jsx("path",{d:"M13 17v2"}),o.jsx("path",{d:"M13 11v2"})]}),de=()=>o.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),o.jsx("path",{d:"m9 12 2 2 4-4"})]}),re=()=>o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:q,children:o.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),ce={card:()=>o.jsxs("div",{className:B,children:[o.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/120px-Visa_Inc._logo.svg.png",alt:"Visa"}),o.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/120px-Mastercard-logo.svg.png",alt:"Mastercard"})]}),orange:()=>o.jsx("div",{className:L,style:{background:"#FF6600"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"Orange"})}),myzaka:()=>o.jsx("div",{className:L,style:{background:"#00A651"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"MyZaka"})}),smega:()=>o.jsx("div",{className:L,style:{background:"#003366"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"Smega"})}),bank:()=>o.jsx(X,{}),cash:()=>o.jsx("span",{style:{fontSize:"32px"},children:"ðŸ’µ"})};function le(){var B;const L=e();s();const{user:q}=t(),{booking:X,selectedRoute:le,selectedSeats:he,passengerDetails:ue}=n();a.useEffect(()=>{try{const e="undefined"!=typeof window?window.location.hash||window.location.pathname:"unknown";fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:114",message:"Payment component mounted",data:{hasUser:!!q,userId:null==q?void 0:q.id,hasSelectedRoute:!!le,selectedRouteId:null==le?void 0:le.id,selectedSeatsCount:null==he?void 0:he.length,passengerDetailsCount:null==ue?void 0:ue.length,currentPath:e},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})}catch(e){}},[]);const[me,pe]=a.useState("card"),[ge,ye]=a.useState(!1),[xe,ve]=a.useState(null),[je,fe]=a.useState([]),[_e,be]=a.useState(null),ke=((null==le?void 0:le.price)||150)*((null==he?void 0:he.length)||1),we=Math.round(.05*ke*100)/100,Pe=X||{tripId:(null==le?void 0:le.id)||"mock-trip-id",route:le||{origin:"Gaborone",destination:"Maun",departureTime:new Date(Date.now()+864e5).toISOString()},seats:he||["2A"],passenger:ue&&ue[0]||{name:(null==(B=null==q?void 0:q.user_metadata)?void 0:B.full_name)||"Guest",phone:"+267 71 234 567",email:(null==q?void 0:q.email)||"guest@example.com"},basePrice:ke,serviceFee:we},Ie=e=>{try{const s=c.calculateTotal(Pe.basePrice||0,Pe.serviceFee||0,e||"card");be(s)}catch(s){i("Error calculating price breakdown",s),be(null)}};a.useEffect(()=>{try{const e=c.getEnabledPaymentMethods();fe(e||[]),Pe.basePrice&&Pe.serviceFee&&Ie("card")}catch(e){i("Error loading payment methods",e),fe([])}},[Pe.basePrice,Pe.serviceFee]);const Se=async()=>{var e,s,t,n;fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:191",message:"handlePayment called",data:{hasBooking:!!X,bookingId:null==X?void 0:X.id,hasSelectedRoute:!!le,selectedRouteId:null==le?void 0:le.id,hasUser:!!q,userId:null==q?void 0:q.id,selectedSeatsCount:null==he?void 0:he.length,passengerDetailsCount:null==ue?void 0:ue.length,selectedMethod:me,hasPriceBreakdown:!!_e,priceBreakdownTotal:null==_e?void 0:_e.total},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),ye(!0),ve(null);try{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:195",message:"handlePayment - starting payment process",data:{loading:!0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});let n=null==X?void 0:X.id;if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:203",message:"Checking if booking needs to be created",data:{hasBooking:!!X,bookingId:null==X?void 0:X.id,hasSelectedRoute:!!le,selectedRouteId:null==le?void 0:le.id,hasUser:!!q,userId:null==q?void 0:q.id,selectedSeatsCount:null==he?void 0:he.length,passengerDetailsCount:null==ue?void 0:ue.length,willCreateBooking:!n&&!!(null==le?void 0:le.id)&&!!(null==q?void 0:q.id)&&(null==he?void 0:he.length)>0&&(null==ue?void 0:ue.length)>0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),!n&&(null==le?void 0:le.id)&&(null==q?void 0:q.id)&&(null==he?void 0:he.length)>0&&(null==ue?void 0:ue.length)>0){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:186",message:"Creating booking - before validation",data:{hasPriceBreakdown:!!_e,priceBreakdownTotal:null==_e?void 0:_e.total,priceBreakdownBase:null==_e?void 0:_e.baseAmount,priceBreakdownService:null==_e?void 0:_e.serviceFee,priceBreakdownPayment:null==_e?void 0:_e.paymentFee,selectedRouteId:null==le?void 0:le.id,userId:null==q?void 0:q.id,seatsCount:null==he?void 0:he.length,passengersCount:null==ue?void 0:ue.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{});let t=_e;if(!t||null===t.total||void 0===t.total){const e=Pe.basePrice||ke,s=Pe.serviceFee||we;t=c.calculateTotal(e,s,me),be(t),fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:192",message:"Recalculated priceBreakdown",data:{recalculatedTotal:t.total,baseAmount:e,serviceFeeAmount:s,selectedMethod:me},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{})}const a=(null==t?void 0:t.total)||(Pe.basePrice||ke)+(Pe.serviceFee||we);if(!a||a<=0)throw new Error("Invalid booking total. Please refresh and try again.");const i=ue[0],o={schedule_id:le.id,user_id:q.id,seats:he,passengers:ue,total_amount:a,total_price:a,passenger_name:(null==i?void 0:i.fullName)||(null==i?void 0:i.name)||"Guest",passenger_email:(null==i?void 0:i.email)||(null==q?void 0:q.email)||"",passenger_phone:(null==i?void 0:i.phone)||"",origin:le.origin,destination:le.destination,departure_time:le.departure_time,payment_status:"unpaid",status:"pending"};fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:210",message:"Sending booking data",data:{total_amount:o.total_amount,total_price:o.total_price,schedule_id:o.schedule_id,user_id:o.user_id,seatsCount:null==(e=o.seats)?void 0:e.length,passengersCount:null==(s=o.passengers)?void 0:s.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{});n=(await d.createBooking(o)).id,fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:217",message:"Booking created successfully",data:{bookingId:n},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{})}if(!n)throw fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:263",message:"No bookingId - throwing error",data:{hasBooking:!!X,hasSelectedRoute:!!le,hasUser:!!q,selectedSeatsCount:null==he?void 0:he.length,passengerDetailsCount:null==ue?void 0:ue.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),new Error("Unable to create booking. Please try again.");fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:265",message:"Booking ID confirmed - proceeding to payment",data:{bookingId:n},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});const a=Pe.passenger||(null==ue?void 0:ue[0])||{},i=(null==_e?void 0:_e.total)||(Pe.basePrice||ke)+(Pe.serviceFee||we),o={bookingId:n,amount:i,paymentMethod:me,customerName:a.name||a.fullName||a.full_name||(null==(t=null==q?void 0:q.user_metadata)?void 0:t.full_name)||"Guest",customerEmail:a.email||(null==q?void 0:q.email)||"",customerPhone:a.phone||a.phone_number||"",description:`GOGOBUS: ${(null==le?void 0:le.origin)||Pe.route.origin} â†’ ${(null==le?void 0:le.destination)||Pe.route.destination}`};fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:275",message:"About to initiate payment",data:{bookingId:n,amount:i,paymentMethod:me,hasPaymentData:!!o},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});const l=await c.initiatePayment(o);if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:278",message:"Payment initiated - result received",data:{success:null==l?void 0:l.success,hasTransactionRef:!!(null==l?void 0:l.transactionRef),hasPaymentUrl:!!(null==l?void 0:l.paymentUrl),error:null==l?void 0:l.error,USE_MOCK_PAYMENTS:r},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),!l.success)throw fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:280",message:"Payment failed - result.success is false",data:{error:null==l?void 0:l.error},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),new Error(l.error);r&&(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:286",message:"Mock payment - navigating to confirmation",data:{transactionRef:l.transactionRef,method:me,targetPath:`/booking/confirmation?ref=${l.transactionRef}&method=${me}`},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),L(`/booking/confirmation?ref=${l.transactionRef}&method=${me}`))}catch(a){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:305",message:"Payment error caught",data:{errorMessage:null==a?void 0:a.message,errorName:null==a?void 0:a.name,errorStack:null==(n=null==a?void 0:a.stack)?void 0:n.substring(0,500)},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),i("Payment error",a),ve(a.message||"Payment failed. Please try again.")}finally{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:310",message:"handlePayment finally block - setting loading to false",data:{},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),ye(!1)}},Ne=e=>`P${e.toFixed(2)}`;return a.useEffect(()=>{try{const e="undefined"!=typeof window?window.location.hash||window.location.pathname:"unknown";fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:310",message:"Payment useEffect - checking context data",data:{hasSelectedRoute:!!le,selectedRouteId:null==le?void 0:le.id,selectedSeatsCount:null==he?void 0:he.length,passengerDetailsCount:null==ue?void 0:ue.length,currentPath:e},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})}catch(e){}if(!le||!he||0===he.length){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:312",message:"Payment redirecting - missing data",data:{hasSelectedRoute:!!le,selectedSeatsCount:null==he?void 0:he.length,redirectTarget:"/booking/summary"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{});const e=setTimeout(()=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:315",message:"Payment executing redirect to summary",data:{redirectTarget:"/booking/summary"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{}),L("/booking/summary")},500);return()=>clearTimeout(e)}fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:318",message:"Payment has valid data - no redirect",data:{hasSelectedRoute:!!le,selectedSeatsCount:null==he?void 0:he.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})},[le,he,L,ue]),le&&he&&0!==he.length?o.jsxs("div",{className:h,children:[o.jsxs("header",{className:u,children:[o.jsx("button",{className:m,onClick:()=>L(-1),children:o.jsx(te,{})}),o.jsx("h1",{className:p,children:"Payment"}),o.jsxs("div",{className:g,children:[o.jsx(se,{}),o.jsx("span",{children:"Secure"})]})]}),o.jsxs("div",{className:y,children:[o.jsxs("div",{className:x,children:[o.jsxs("div",{className:v,children:[o.jsx(ne,{}),o.jsx("span",{children:"Trip Summary"})]}),o.jsxs("div",{className:j,children:[o.jsxs("div",{className:f,children:[o.jsx("div",{className:_}),o.jsx("span",{children:(null==le?void 0:le.origin)||Pe.route.origin})]}),o.jsx("div",{className:k}),o.jsxs("div",{className:f,children:[o.jsx("div",{className:`${_} ${b}`}),o.jsx("span",{children:(null==le?void 0:le.destination)||Pe.route.destination})]})]}),o.jsxs("div",{className:w,children:[((null==le?void 0:le.departure_time)||Pe.route.departureTime)&&o.jsxs("div",{className:P,children:[o.jsx(ae,{}),o.jsx("span",{children:(null==le?void 0:le.departure_time)||(e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString("en-BW",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}catch(s){return e}})(Pe.route.departureTime)})]}),Pe.passenger&&o.jsxs("div",{className:P,children:[o.jsx(ie,{}),o.jsx("span",{children:Pe.passenger.name||Pe.passenger.full_name})]}),o.jsxs("div",{className:P,children:[o.jsx(oe,{}),o.jsxs("span",{children:["Seat ",Pe.seats.join(", ")]})]})]})]}),(null==le?void 0:le.id)&&o.jsx("div",{className:S,children:o.jsx(l,{routeId:le.id,tripId:le.id,trip:le,bookingId:null==X?void 0:X.id,route:le})}),o.jsxs("div",{className:I,children:[o.jsx("h2",{className:N,children:"Select Payment Method"}),o.jsx("div",{className:T,children:je.map(e=>o.jsxs("div",{className:`${C} ${me===e.id?O:""}`,onClick:()=>{return s=e.id,pe(s),Ie(s),void ve(null);var s},children:[o.jsx("div",{className:M,children:me===e.id&&o.jsx(ee,{})}),o.jsx("div",{className:D,children:ce[e.icon]?ce[e.icon]():o.jsx(Q,{})}),o.jsxs("div",{className:R,children:[o.jsx("div",{className:F,children:e.name}),o.jsx("div",{className:J,children:e.description})]}),e.fees.value>0&&o.jsx("div",{className:G,children:"percentage"===e.fees.type?`${e.fees.value}% fee`:`P${e.fees.value} fee`})]},e.id))})]}),o.jsxs("div",{className:z,children:[o.jsx(de,{}),o.jsxs("div",{className:Z,children:[o.jsx("strong",{children:"Payment will be completed at the station."}),o.jsx("span",{children:"Ticket reserved now."})]})]}),_e&&o.jsxs("div",{className:I,children:[o.jsx("h2",{className:N,children:"Price Breakdown"}),o.jsxs("div",{className:W,children:[o.jsxs("div",{className:$,children:[o.jsx("span",{children:"Ticket Price"}),o.jsx("span",{children:Ne(_e.baseAmount)})]}),o.jsxs("div",{className:$,children:[o.jsx("span",{children:"Service Fee"}),o.jsx("span",{children:Ne(_e.serviceFee)})]}),_e.paymentFee>0&&o.jsxs("div",{className:$,children:[o.jsx("span",{children:"Payment Fee"}),o.jsx("span",{children:Ne(_e.paymentFee)})]}),o.jsx("div",{className:A}),o.jsxs("div",{className:`${$} ${E}`,children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:Ne(_e.total)})]})]})]}),o.jsxs("div",{className:U,children:[o.jsx(de,{}),o.jsxs("div",{className:V,children:[o.jsx("strong",{children:"Secure Payment"}),o.jsx("span",{children:"Your payment is protected with 256-bit SSL encryption"})]})]}),xe&&o.jsx("div",{className:H,children:xe}),o.jsx("button",{className:Y,onClick:e=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:515",message:"Pay button clicked",data:{loading:ge,disabled:ge,hasHandlePayment:!!Se,priceBreakdownTotal:null==_e?void 0:_e.total},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),ge||Se()},disabled:ge,children:ge?o.jsxs(o.Fragment,{children:[o.jsx(re,{}),"Processing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(se,{}),"Pay ",_e?Ne(_e.total):""]})}),o.jsxs("p",{className:K,children:["By proceeding, you agree to our"," ",o.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",o.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})]})]}):o.jsx("div",{className:h,children:o.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[o.jsx("p",{children:"Loading payment information..."}),o.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"#666"},children:"Redirecting to booking summary..."})]})})}export{le as default};
