import{l as e,s as o,b as s,c as i}from"./index-CQfapMY1.js";const n={async sendBookingConfirmation(n){try{if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"emailService.js:sendBookingConfirmation",message:"Attempting to send booking confirmation email",data:{bookingId:n.bookingId,customerEmail:n.customerEmail,hasEmail:!!n.customerEmail},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"M"})}).catch(()=>{}),!n.customerEmail)return fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"emailService.js:sendBookingConfirmation",message:"No customer email provided",data:{},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"M"})}).catch(()=>{}),e("Cannot send booking confirmation: no email provided"),{success:!1,error:"No email address provided"};const{data:i,error:a}=await o.functions.invoke("send-booking-email",{body:{bookingId:n.bookingId,customerEmail:n.customerEmail,customerName:n.customerName||"Customer",origin:n.origin,destination:n.destination,departureTime:n.departureTime,seats:n.seats||[],totalAmount:n.totalAmount,bookingRef:n.bookingRef||n.bookingId}});return a?(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"emailService.js:sendBookingConfirmation",message:"Edge function error (may not exist)",data:{errorMessage:a.message,errorName:a.name},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"M"})}).catch(()=>{}),e("Email edge function not available or failed:",a.message),{success:!1,error:a.message,warning:!0}):(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"emailService.js:sendBookingConfirmation",message:"Email sent successfully",data:{bookingId:n.bookingId,customerEmail:n.customerEmail},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"M"})}).catch(()=>{}),s("Booking confirmation email sent",{bookingId:n.bookingId,email:n.customerEmail}),{success:!0,data:i})}catch(a){return fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"emailService.js:sendBookingConfirmation",message:"Email sending exception",data:{errorMessage:null==a?void 0:a.message,errorName:null==a?void 0:a.name},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"M"})}).catch(()=>{}),i("Error sending booking confirmation email",a),{success:!1,error:a.message,warning:!0}}}};export{n as e};
