import{u as e,m as s,a as t,o as n,r as a,c as i,j as o,q as d,U as c}from"./index-D2RF4Oxz.js";import{p as r}from"./paymentService-BrK5PML_.js";const l="_paymentPage_48kcz_6",h="_header_48kcz_13",u="_backBtn_48kcz_25",m="_headerTitle_48kcz_42",p="_secureIcon_48kcz_49",g="_content_48kcz_60",y="_tripSummary_48kcz_68",x="_tripHeader_48kcz_76",v="_tripRoute_48kcz_86",j="_routePoint_48kcz_92",f="_routeDot_48kcz_100",_="_destination_48kcz_108",k="_routeLine_48kcz_113",b="_tripDetails_48kcz_121",w="_tripDetail_48kcz_121",P="_section_48kcz_144",I="_sectionTitle_48kcz_148",S="_methodsList_48kcz_157",N="_methodCard_48kcz_163",T="_selected_48kcz_180",C="_methodRadio_48kcz_185",O="_methodIcon_48kcz_203",z="_brandLogos_48kcz_213",M="_providerLogo_48kcz_225",D="_methodInfo_48kcz_233",B="_methodName_48kcz_238",L="_methodDesc_48kcz_245",R="_methodFee_48kcz_250",F="_priceCard_48kcz_261",J="_priceRow_48kcz_268",G="_total_48kcz_277",W="_priceDivider_48kcz_283",$="_securityBadge_48kcz_291",E="_securityText_48kcz_307",A="_errorMessage_48kcz_325",U="_mockPaymentNotice_48kcz_338",V="_mockPaymentText_48kcz_356",H="_payButton_48kcz_375",Z="_spinner_48kcz_408",Y="_terms_48kcz_419",q=()=>o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),K=()=>o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",ry:"2"}),o.jsx("path",{d:"M9 22v-4h6v4"}),o.jsx("path",{d:"M8 6h.01M16 6h.01M12 6h.01M12 10h.01M12 14h.01M16 10h.01M16 14h.01M8 10h.01M8 14h.01"})]}),Q=()=>o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M20 6 9 17l-5-5"})}),X=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),o.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),ee=()=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"m12 19-7-7 7-7"}),o.jsx("path",{d:"M19 12H5"})]}),se=()=>o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M8 6v6m8-6v6M5 18v2m14-2v2M3 6h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6ZM3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2"}),o.jsx("circle",{cx:"7",cy:"15",r:"1"}),o.jsx("circle",{cx:"17",cy:"15",r:"1"})]}),te=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),o.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),o.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),ne=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),ae=()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"}),o.jsx("path",{d:"M13 5v2"}),o.jsx("path",{d:"M13 17v2"}),o.jsx("path",{d:"M13 11v2"})]}),ie=()=>o.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),o.jsx("path",{d:"m9 12 2 2 4-4"})]}),oe=()=>o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:Z,children:o.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),de={card:()=>o.jsxs("div",{className:z,children:[o.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/120px-Visa_Inc._logo.svg.png",alt:"Visa"}),o.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/120px-Mastercard-logo.svg.png",alt:"Mastercard"})]}),orange:()=>o.jsx("div",{className:M,style:{background:"#FF6600"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"Orange"})}),myzaka:()=>o.jsx("div",{className:M,style:{background:"#00A651"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"MyZaka"})}),smega:()=>o.jsx("div",{className:M,style:{background:"#003366"},children:o.jsx("span",{style:{color:"white",fontWeight:700},children:"Smega"})}),bank:()=>o.jsx(K,{}),cash:()=>o.jsx("span",{style:{fontSize:"32px"},children:"ðŸ’µ"})};function ce(){var z;const M=e();s();const{user:Z}=t(),{booking:K,selectedRoute:ce,selectedSeats:re,passengerDetails:le}=n();a.useEffect(()=>{try{const e="undefined"!=typeof window?window.location.hash||window.location.pathname:"unknown";fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:114",message:"Payment component mounted",data:{hasUser:!!Z,userId:null==Z?void 0:Z.id,hasSelectedRoute:!!ce,selectedRouteId:null==ce?void 0:ce.id,selectedSeatsCount:null==re?void 0:re.length,passengerDetailsCount:null==le?void 0:le.length,currentPath:e},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})}catch(e){}},[]);const[he,ue]=a.useState("card"),[me,pe]=a.useState(!1),[ge,ye]=a.useState(null),[xe,ve]=a.useState([]),[je,fe]=a.useState(null),_e=((null==ce?void 0:ce.price)||150)*((null==re?void 0:re.length)||1),ke=Math.round(.05*_e*100)/100,be=K||{tripId:(null==ce?void 0:ce.id)||"mock-trip-id",route:ce||{origin:"Gaborone",destination:"Maun",departureTime:new Date(Date.now()+864e5).toISOString()},seats:re||["2A"],passenger:le&&le[0]||{name:(null==(z=null==Z?void 0:Z.user_metadata)?void 0:z.full_name)||"Guest",phone:"+267 71 234 567",email:(null==Z?void 0:Z.email)||"guest@example.com"},basePrice:_e,serviceFee:ke},we=e=>{try{const s=r.calculateTotal(be.basePrice||0,be.serviceFee||0,e||"card");fe(s)}catch(s){i("Error calculating price breakdown",s),fe(null)}};a.useEffect(()=>{try{const e=r.getEnabledPaymentMethods();ve(e||[]),be.basePrice&&be.serviceFee&&we("card")}catch(e){i("Error loading payment methods",e),ve([])}},[be.basePrice,be.serviceFee]);const Pe=async()=>{var e,s,t,n;fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:191",message:"handlePayment called",data:{hasBooking:!!K,bookingId:null==K?void 0:K.id,hasSelectedRoute:!!ce,selectedRouteId:null==ce?void 0:ce.id,hasUser:!!Z,userId:null==Z?void 0:Z.id,selectedSeatsCount:null==re?void 0:re.length,passengerDetailsCount:null==le?void 0:le.length,selectedMethod:he,hasPriceBreakdown:!!je,priceBreakdownTotal:null==je?void 0:je.total},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),pe(!0),ye(null);try{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:195",message:"handlePayment - starting payment process",data:{loading:!0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});let n=null==K?void 0:K.id;if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:203",message:"Checking if booking needs to be created",data:{hasBooking:!!K,bookingId:null==K?void 0:K.id,hasSelectedRoute:!!ce,selectedRouteId:null==ce?void 0:ce.id,hasUser:!!Z,userId:null==Z?void 0:Z.id,selectedSeatsCount:null==re?void 0:re.length,passengerDetailsCount:null==le?void 0:le.length,willCreateBooking:!n&&!!(null==ce?void 0:ce.id)&&!!(null==Z?void 0:Z.id)&&(null==re?void 0:re.length)>0&&(null==le?void 0:le.length)>0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),!n&&(null==ce?void 0:ce.id)&&(null==Z?void 0:Z.id)&&(null==re?void 0:re.length)>0&&(null==le?void 0:le.length)>0){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:186",message:"Creating booking - before validation",data:{hasPriceBreakdown:!!je,priceBreakdownTotal:null==je?void 0:je.total,priceBreakdownBase:null==je?void 0:je.baseAmount,priceBreakdownService:null==je?void 0:je.serviceFee,priceBreakdownPayment:null==je?void 0:je.paymentFee,selectedRouteId:null==ce?void 0:ce.id,userId:null==Z?void 0:Z.id,seatsCount:null==re?void 0:re.length,passengersCount:null==le?void 0:le.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{});let t=je;if(!t||null===t.total||void 0===t.total){const e=be.basePrice||_e,s=be.serviceFee||ke;t=r.calculateTotal(e,s,he),fe(t),fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:192",message:"Recalculated priceBreakdown",data:{recalculatedTotal:t.total,baseAmount:e,serviceFeeAmount:s,selectedMethod:he},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{})}const a=(null==t?void 0:t.total)||(be.basePrice||_e)+(be.serviceFee||ke);if(!a||a<=0)throw new Error("Invalid booking total. Please refresh and try again.");const i=le[0],o={schedule_id:ce.id,user_id:Z.id,seats:re,passengers:le,total_amount:a,total_price:a,passenger_name:(null==i?void 0:i.fullName)||(null==i?void 0:i.name)||"Guest",passenger_email:(null==i?void 0:i.email)||(null==Z?void 0:Z.email)||"",passenger_phone:(null==i?void 0:i.phone)||"",origin:ce.origin,destination:ce.destination,departure_time:ce.departure_time,payment_status:"unpaid",status:"pending"};fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:210",message:"Sending booking data",data:{total_amount:o.total_amount,total_price:o.total_price,schedule_id:o.schedule_id,user_id:o.user_id,seatsCount:null==(e=o.seats)?void 0:e.length,passengersCount:null==(s=o.passengers)?void 0:s.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{});n=(await d.createBooking(o)).id,fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:217",message:"Booking created successfully",data:{bookingId:n},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"L"})}).catch(()=>{})}if(!n)throw fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:263",message:"No bookingId - throwing error",data:{hasBooking:!!K,hasSelectedRoute:!!ce,hasUser:!!Z,selectedSeatsCount:null==re?void 0:re.length,passengerDetailsCount:null==le?void 0:le.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),new Error("Unable to create booking. Please try again.");fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:265",message:"Booking ID confirmed - proceeding to payment",data:{bookingId:n},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});const a=be.passenger||(null==le?void 0:le[0])||{},i=(null==je?void 0:je.total)||(be.basePrice||_e)+(be.serviceFee||ke),o={bookingId:n,amount:i,paymentMethod:he,customerName:a.name||a.fullName||a.full_name||(null==(t=null==Z?void 0:Z.user_metadata)?void 0:t.full_name)||"Guest",customerEmail:a.email||(null==Z?void 0:Z.email)||"",customerPhone:a.phone||a.phone_number||"",description:`GOGOBUS: ${(null==ce?void 0:ce.origin)||be.route.origin} â†’ ${(null==ce?void 0:ce.destination)||be.route.destination}`};fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:275",message:"About to initiate payment",data:{bookingId:n,amount:i,paymentMethod:he,hasPaymentData:!!o},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{});const l=await r.initiatePayment(o);if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:278",message:"Payment initiated - result received",data:{success:null==l?void 0:l.success,hasTransactionRef:!!(null==l?void 0:l.transactionRef),hasPaymentUrl:!!(null==l?void 0:l.paymentUrl),error:null==l?void 0:l.error,USE_MOCK_PAYMENTS:c},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),!l.success)throw fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:280",message:"Payment failed - result.success is false",data:{error:null==l?void 0:l.error},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),new Error(l.error);c&&(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:286",message:"Mock payment - navigating to confirmation",data:{transactionRef:l.transactionRef,method:he,targetPath:`/booking/confirmation?ref=${l.transactionRef}&method=${he}`},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),M(`/booking/confirmation?ref=${l.transactionRef}&method=${he}`))}catch(a){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:305",message:"Payment error caught",data:{errorMessage:null==a?void 0:a.message,errorName:null==a?void 0:a.name,errorStack:null==(n=null==a?void 0:a.stack)?void 0:n.substring(0,500)},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),i("Payment error",a),ye(a.message||"Payment failed. Please try again.")}finally{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:310",message:"handlePayment finally block - setting loading to false",data:{},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),pe(!1)}},Ie=e=>`P${e.toFixed(2)}`;return a.useEffect(()=>{try{const e="undefined"!=typeof window?window.location.hash||window.location.pathname:"unknown";fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:310",message:"Payment useEffect - checking context data",data:{hasSelectedRoute:!!ce,selectedRouteId:null==ce?void 0:ce.id,selectedSeatsCount:null==re?void 0:re.length,passengerDetailsCount:null==le?void 0:le.length,currentPath:e},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})}catch(e){}if(!ce||!re||0===re.length){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:312",message:"Payment redirecting - missing data",data:{hasSelectedRoute:!!ce,selectedSeatsCount:null==re?void 0:re.length,redirectTarget:"/booking/summary"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{});const e=setTimeout(()=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:315",message:"Payment executing redirect to summary",data:{redirectTarget:"/booking/summary"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{}),M("/booking/summary")},500);return()=>clearTimeout(e)}fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:318",message:"Payment has valid data - no redirect",data:{hasSelectedRoute:!!ce,selectedSeatsCount:null==re?void 0:re.length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})},[ce,re,M,le]),ce&&re&&0!==re.length?o.jsxs("div",{className:l,children:[o.jsxs("header",{className:h,children:[o.jsx("button",{className:u,onClick:()=>M(-1),children:o.jsx(ee,{})}),o.jsx("h1",{className:m,children:"Payment"}),o.jsxs("div",{className:p,children:[o.jsx(X,{}),o.jsx("span",{children:"Secure"})]})]}),o.jsxs("div",{className:g,children:[o.jsxs("div",{className:y,children:[o.jsxs("div",{className:x,children:[o.jsx(se,{}),o.jsx("span",{children:"Trip Summary"})]}),o.jsxs("div",{className:v,children:[o.jsxs("div",{className:j,children:[o.jsx("div",{className:f}),o.jsx("span",{children:(null==ce?void 0:ce.origin)||be.route.origin})]}),o.jsx("div",{className:k}),o.jsxs("div",{className:j,children:[o.jsx("div",{className:`${f} ${_}`}),o.jsx("span",{children:(null==ce?void 0:ce.destination)||be.route.destination})]})]}),o.jsxs("div",{className:b,children:[((null==ce?void 0:ce.departure_time)||be.route.departureTime)&&o.jsxs("div",{className:w,children:[o.jsx(te,{}),o.jsx("span",{children:(null==ce?void 0:ce.departure_time)||(e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString("en-BW",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}catch(s){return e}})(be.route.departureTime)})]}),be.passenger&&o.jsxs("div",{className:w,children:[o.jsx(ne,{}),o.jsx("span",{children:be.passenger.name||be.passenger.full_name})]}),o.jsxs("div",{className:w,children:[o.jsx(ae,{}),o.jsxs("span",{children:["Seat ",be.seats.join(", ")]})]})]})]}),o.jsxs("div",{className:P,children:[o.jsx("h2",{className:I,children:"Select Payment Method"}),o.jsx("div",{className:S,children:xe.map(e=>o.jsxs("div",{className:`${N} ${he===e.id?T:""}`,onClick:()=>{return s=e.id,ue(s),we(s),void ye(null);var s},children:[o.jsx("div",{className:C,children:he===e.id&&o.jsx(Q,{})}),o.jsx("div",{className:O,children:de[e.icon]?de[e.icon]():o.jsx(q,{})}),o.jsxs("div",{className:D,children:[o.jsx("div",{className:B,children:e.name}),o.jsx("div",{className:L,children:e.description})]}),e.fees.value>0&&o.jsx("div",{className:R,children:"percentage"===e.fees.type?`${e.fees.value}% fee`:`P${e.fees.value} fee`})]},e.id))})]}),o.jsxs("div",{className:U,children:[o.jsx(ie,{}),o.jsxs("div",{className:V,children:[o.jsx("strong",{children:"Payment will be completed at the station."}),o.jsx("span",{children:"Ticket reserved now."})]})]}),je&&o.jsxs("div",{className:P,children:[o.jsx("h2",{className:I,children:"Price Breakdown"}),o.jsxs("div",{className:F,children:[o.jsxs("div",{className:J,children:[o.jsx("span",{children:"Ticket Price"}),o.jsx("span",{children:Ie(je.baseAmount)})]}),o.jsxs("div",{className:J,children:[o.jsx("span",{children:"Service Fee"}),o.jsx("span",{children:Ie(je.serviceFee)})]}),je.paymentFee>0&&o.jsxs("div",{className:J,children:[o.jsx("span",{children:"Payment Fee"}),o.jsx("span",{children:Ie(je.paymentFee)})]}),o.jsx("div",{className:W}),o.jsxs("div",{className:`${J} ${G}`,children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:Ie(je.total)})]})]})]}),o.jsxs("div",{className:$,children:[o.jsx(ie,{}),o.jsxs("div",{className:E,children:[o.jsx("strong",{children:"Secure Payment"}),o.jsx("span",{children:"Your payment is protected with 256-bit SSL encryption"})]})]}),ge&&o.jsx("div",{className:A,children:ge}),o.jsx("button",{className:H,onClick:e=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Payment.jsx:515",message:"Pay button clicked",data:{loading:me,disabled:me,hasHandlePayment:!!Pe,priceBreakdownTotal:null==je?void 0:je.total},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"G"})}).catch(()=>{}),me||Pe()},disabled:me,children:me?o.jsxs(o.Fragment,{children:[o.jsx(oe,{}),"Processing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(X,{}),"Pay ",je?Ie(je.total):""]})}),o.jsxs("p",{className:Y,children:["By proceeding, you agree to our"," ",o.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",o.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})]})]}):o.jsx("div",{className:l,children:o.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[o.jsx("p",{children:"Loading payment information..."}),o.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"#666"},children:"Redirecting to booking summary..."})]})})}export{ce as default};
