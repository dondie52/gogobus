import{u as e,i as s,r as a,j as t,d as i,c as r}from"./index-DzaH6n5y.js";import{b as n}from"./bookingService-CURIds-i.js";import"./validation-DjNTQiWP.js";const l="_searchPage_1pt2a_6",o="_header_1pt2a_13",d="_backBtn_1pt2a_25",c="_headerContent_1pt2a_42",h="_headerTitle_1pt2a_46",x="_headerMeta_1pt2a_53",_="_modifyBtn_1pt2a_71",p="_filters_1pt2a_88",u="_filterGroup_1pt2a_98",j="_resultsCount_1pt2a_120",m="_content_1pt2a_128",v="_loading_1pt2a_136",g="_spinner_1pt2a_141",N="_error_1pt2a_161",k="_empty_1pt2a_162",y="_tripsList_1pt2a_213",b="_tripCard_1pt2a_219",w="_tripMain_1pt2a_232",f="_tripTimes_1pt2a_242",L="_timeBlock_1pt2a_248",B="_time_1pt2a_248",C="_city_1pt2a_260",S="_duration_1pt2a_265",M="_durationLine_1pt2a_273",W="_durationDot_1pt2a_279",D="_durationDash_1pt2a_287",T="_busInfo_1pt2a_312",$="_busName_1pt2a_316",P="_busType_1pt2a_323",A="_amenities_1pt2a_330",H="_amenity_1pt2a_335",I="_seatsInfo_1pt2a_348",E="_seatsCount_1pt2a_353",O="_low_1pt2a_363",F="_priceAction_1pt2a_370",G="_price_1pt2a_370",V="_priceAmount_1pt2a_382",Z="_priceLabel_1pt2a_389",q="_selectBtn_1pt2a_394",z="_lowSeatsWarning_1pt2a_422",J=()=>t.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"m12 19-7-7 7-7"}),t.jsx("path",{d:"M19 12H5"})]}),K=()=>t.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M8 6v6m8-6v6M5 18v2m14-2v2M3 6h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6ZM3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2"}),t.jsx("circle",{cx:"7",cy:"15",r:"1"}),t.jsx("circle",{cx:"17",cy:"15",r:"1"})]}),Q=()=>t.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"9",cy:"7",r:"4"})]}),R=()=>t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),t.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),t.jsx("circle",{cx:"12",cy:"20",r:"1"})]}),U=()=>t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),t.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"22"}),t.jsx("path",{d:"m20 16-4-4 4-4"}),t.jsx("path",{d:"m4 8 4 4-4 4"}),t.jsx("path",{d:"m16 4-4 4-4-4"}),t.jsx("path",{d:"m8 20 4-4 4 4"})]}),X=()=>t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0"}),t.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"12"})]}),Y=()=>t.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"m9 18 6-6-6-6"})}),ee=()=>t.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),se=()=>t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),t.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),t.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),t.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),ae=({type:e})=>({wifi:t.jsx(R,{}),ac:t.jsx(U,{}),power:t.jsx(X,{})}[e]||null);function te(){const R=e(),[U]=s(),X=U.get("from")||"",te=U.get("to")||"",ie=U.get("date")||"",re=parseInt(U.get("passengers")||"1"),[ne,le]=a.useState([]),[oe,de]=a.useState(!0),[ce,he]=a.useState(null),[xe,_e]=a.useState("departure"),[pe,ue]=a.useState("all");a.useEffect(()=>{(async()=>{if(!X||!te||!ie)return he("Invalid search parameters"),void de(!1);de(!0),he(null);try{const{data:e,error:s}=await n.searchTrips({origin:X,destination:te,date:ie,passengers:re});if(s)throw s;le(e||[])}catch(e){r("Search error",e),he(e.message||"Failed to search trips")}finally{de(!1)}})()},[X,te,ie,re]);const je=[...ne].filter(e=>{var s;return"all"===pe||(null==(s=e.buses)?void 0:s.bus_type)===pe}).sort((e,s)=>{var a,t;switch(xe){case"price":return e.price-s.price;case"duration":return((null==(a=e.routes)?void 0:a.duration_minutes)||0)-((null==(t=s.routes)?void 0:t.duration_minutes)||0);default:return new Date(e.departure_time)-new Date(s.departure_time)}}),me=e=>new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit"}),ve=e=>new Date(e).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}),ge=e=>{if(!e)return"N/A";return`${Math.floor(e/60)}h ${e%60}m`},Ne=[...new Set(ne.map(e=>{var s;return null==(s=e.buses)?void 0:s.bus_type}).filter(Boolean))];return t.jsxs("div",{className:l,children:[t.jsxs("header",{className:o,children:[t.jsx("button",{className:d,onClick:e=>{window.history.length>1?R(-1):R("/home")},children:t.jsx(J,{})}),t.jsxs("div",{className:c,children:[t.jsxs("h1",{className:h,children:[X," → ",te]}),t.jsxs("div",{className:x,children:[t.jsxs("span",{children:[t.jsx(se,{})," ",ve(ie)]}),t.jsxs("span",{children:[t.jsx(Q,{})," ",re," ",1===re?"Passenger":"Passengers"]})]})]}),t.jsx(i,{to:"/",className:_,children:"Modify"})]}),ne.length>0&&t.jsxs("div",{className:p,children:[t.jsxs("div",{className:u,children:[t.jsx("label",{children:"Sort by:"}),t.jsxs("select",{value:xe,onChange:e=>_e(e.target.value),children:[t.jsx("option",{value:"departure",children:"Departure Time"}),t.jsx("option",{value:"price",children:"Price (Low to High)"}),t.jsx("option",{value:"duration",children:"Duration"})]})]}),Ne.length>1&&t.jsxs("div",{className:u,children:[t.jsx("label",{children:"Bus Type:"}),t.jsxs("select",{value:pe,onChange:e=>ue(e.target.value),children:[t.jsx("option",{value:"all",children:"All Types"}),Ne.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{className:j,children:[je.length," ",1===je.length?"bus":"buses"," found"]})]}),t.jsx("div",{className:m,children:oe?t.jsxs("div",{className:v,children:[t.jsx("div",{className:g}),t.jsx("p",{children:"Searching for available buses..."})]}):ce?t.jsxs("div",{className:N,children:[t.jsx(ee,{}),t.jsx("h2",{children:"Oops! Something went wrong"}),t.jsx("p",{children:ce}),t.jsx("button",{onClick:()=>R("/"),children:"Back to Search"})]}):0===je.length?t.jsxs("div",{className:k,children:[t.jsx(K,{}),t.jsx("h2",{children:"No buses found"}),t.jsxs("p",{children:["No buses available from ",X," to ",te," on ",ve(ie),". Try a different date or route."]}),t.jsx("button",{onClick:()=>R("/"),children:"Search Again"})]}):t.jsx("div",{className:y,children:je.map(e=>{var s,a,i,r,n,l;return e.available_seats,t.jsxs("div",{className:b,children:[t.jsxs("div",{className:w,children:[t.jsxs("div",{className:f,children:[t.jsxs("div",{className:L,children:[t.jsx("span",{className:B,children:me(e.departure_time)}),t.jsx("span",{className:C,children:X})]}),t.jsxs("div",{className:S,children:[t.jsxs("div",{className:M,children:[t.jsx("div",{className:W}),t.jsx("div",{className:D}),t.jsx(K,{}),t.jsx("div",{className:D}),t.jsx("div",{className:W})]}),t.jsx("span",{children:ge(null==(s=e.routes)?void 0:s.duration_minutes)})]}),t.jsxs("div",{className:L,children:[t.jsx("span",{className:B,children:e.arrival_time?me(e.arrival_time):"~"+me(new Date(new Date(e.departure_time).getTime()+6e4*((null==(a=e.routes)?void 0:a.duration_minutes)||0)))}),t.jsx("span",{className:C,children:te})]})]}),t.jsxs("div",{className:T,children:[t.jsx("div",{className:$,children:(null==(i=e.buses)?void 0:i.bus_name)||"Standard Bus"}),t.jsx("div",{className:P,children:(null==(r=e.buses)?void 0:r.bus_type)||"standard"}),(null==(n=e.buses)?void 0:n.amenities)&&e.buses.amenities.length>0&&t.jsx("div",{className:A,children:e.buses.amenities.map(e=>t.jsx("span",{className:H,title:e,children:t.jsx(ae,{type:e})},e))})]}),t.jsx("div",{className:I,children:t.jsxs("span",{className:`${E} ${e.available_seats<=5?O:""}`,children:[e.available_seats," ",1===e.available_seats?"seat":"seats"," left"]})}),t.jsxs("div",{className:F,children:[t.jsxs("div",{className:G,children:[t.jsx("span",{className:V,children:(l=e.price,`P${l}`)}),t.jsx("span",{className:Z,children:"per person"})]}),t.jsxs("button",{className:q,type:"button","data-trip-id":e.id,onClick:s=>{s.stopPropagation(),(e=>{R(`/booking/seats/${e.id}?passengers=${re}`)})(e)},disabled:e.available_seats<re,children:["Select",t.jsx(Y,{style:{pointerEvents:"none"}})]})]})]}),e.available_seats<=5&&e.available_seats>=re&&t.jsxs("div",{className:z,children:["⚡ Only ",e.available_seats," seats remaining - Book now!"]})]},e.id)})})})]})}export{te as default};
