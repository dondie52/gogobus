import{u as e,m as s,n as i,o as a,r,j as n,d as t,q as l,c as o}from"./index-CFOqP2ng.js";import{L as d}from"./LiveTrackingCard-Cli4SqCK.js";import"./trackingService-CENjMGR4.js";const c="_searchPage_10pa0_6",h="_header_10pa0_13",x="_backBtn_10pa0_25",u="_headerContent_10pa0_42",_="_headerTitle_10pa0_46",p="_headerMeta_10pa0_53",j="_modifyBtn_10pa0_71",m="_filters_10pa0_88",v="_filterGroup_10pa0_98",g="_resultsCount_10pa0_120",y="_content_10pa0_128",k="_loading_10pa0_136",w="_spinner_10pa0_141",N="_error_10pa0_161",b="_empty_10pa0_162",f="_tripsList_10pa0_213",L="_tripCard_10pa0_219",C="_tripMain_10pa0_232",B="_tripTimes_10pa0_242",S="_timeBlock_10pa0_248",M="_time_10pa0_248",W="_city_10pa0_260",D="_duration_10pa0_265",T="_durationLine_10pa0_273",P="_durationDot_10pa0_279",$="_durationDash_10pa0_287",I="_busInfo_10pa0_312",A="_busName_10pa0_316",H="_busType_10pa0_323",E="_amenities_10pa0_330",O="_amenity_10pa0_335",R="_seatsInfo_10pa0_348",q="_seatsCount_10pa0_353",F="_low_10pa0_363",G="_priceAction_10pa0_370",U="_price_10pa0_370",V="_priceAmount_10pa0_382",Z="_priceLabel_10pa0_389",z="_selectBtn_10pa0_394",J="_trackingSection_10pa0_422",K="_lowSeatsWarning_10pa0_430",Q=()=>n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]}),X=()=>n.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M8 6v6m8-6v6M5 18v2m14-2v2M3 6h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6ZM3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2"}),n.jsx("circle",{cx:"7",cy:"15",r:"1"}),n.jsx("circle",{cx:"17",cy:"15",r:"1"})]}),Y=()=>n.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"9",cy:"7",r:"4"})]}),ee=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),n.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),n.jsx("circle",{cx:"12",cy:"20",r:"1"})]}),se=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"22"}),n.jsx("path",{d:"m20 16-4-4 4-4"}),n.jsx("path",{d:"m4 8 4 4-4 4"}),n.jsx("path",{d:"m16 4-4 4-4-4"}),n.jsx("path",{d:"m8 20 4-4 4 4"})]}),ie=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0"}),n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"12"})]}),ae=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("rect",{x:"2",y:"7",width:"20",height:"10",rx:"2",ry:"2"}),n.jsx("line",{x1:"6",y1:"11",x2:"6",y2:"13"}),n.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"13"}),n.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"13"}),n.jsx("line",{x1:"18",y1:"11",x2:"18",y2:"13"}),n.jsx("path",{d:"M12 2v5M8 2v3M16 2v3"})]}),re=()=>n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:n.jsx("path",{d:"m9 18 6-6-6-6"})}),ne=()=>n.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),n.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),te=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),n.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),n.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),n.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),le=({type:e})=>({wifi:n.jsx(ee,{}),ac:n.jsx(se,{}),aircon:n.jsx(se,{}),"air conditioning":n.jsx(se,{}),power:n.jsx(ie,{}),usb:n.jsx(ae,{}),charging:n.jsx(ae,{}),"charging port":n.jsx(ae,{}),charging_port:n.jsx(ae,{}),"charging-port":n.jsx(ae,{})}[(e||"").toLowerCase().trim()]||null);function oe(){const ee=e(),[se]=s(),{searchParams:ie}=i(),{setSelectedRoute:ae}=a(),oe=(()=>{try{const e=window.location.hash;if(e.includes("?")){const s=e.split("?")[1];return new URLSearchParams(s)}}catch(e){}return null})(),de=((null==oe?void 0:oe.get("from"))||se.get("from")||ie.origin||"").trim(),ce=((null==oe?void 0:oe.get("to"))||se.get("to")||ie.destination||"").trim(),he=((null==oe?void 0:oe.get("date"))||se.get("date")||ie.date||"").trim(),xe=parseInt((null==oe?void 0:oe.get("passengers"))||se.get("passengers")||"1"),[ue,_e]=r.useState([]),[pe,je]=r.useState(!0),[me,ve]=r.useState(null),[ge,ye]=r.useState("departure"),[ke,we]=r.useState("all");r.useEffect(()=>{(async()=>{if(!de||!ce||!he)return ve("Invalid search parameters. Please go back and try your search again."),void je(!1);je(!0),ve(null);try{const{data:e,error:s}=await l.searchTrips({origin:de,destination:ce,date:he,passengers:xe});if(s)throw s;_e(e||[])}catch(e){o("Search error",e),ve(e.message||"Failed to search trips")}finally{je(!1)}})()},[de,ce,he,xe]);const Ne=[...ue].filter(e=>{var s;return"all"===ke||(null==(s=e.buses)?void 0:s.bus_type)===ke}).sort((e,s)=>{var i,a;switch(ge){case"price":return e.price-s.price;case"duration":return((null==(i=e.routes)?void 0:i.duration_minutes)||0)-((null==(a=s.routes)?void 0:a.duration_minutes)||0);default:return new Date(e.departure_time)-new Date(s.departure_time)}}),be=e=>new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit"}),fe=e=>new Date(e).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}),Le=e=>{if(!e)return"N/A";return`${Math.floor(e/60)}h ${e%60}m`},Ce=[...new Set(ue.map(e=>{var s;return null==(s=e.buses)?void 0:s.bus_type}).filter(Boolean))];return n.jsxs("div",{className:c,children:[n.jsxs("header",{className:h,children:[n.jsx("button",{className:x,onClick:e=>{window.history.length>1?ee(-1):ee("/home")},children:n.jsx(Q,{})}),n.jsxs("div",{className:u,children:[n.jsxs("h1",{className:_,children:[de," → ",ce]}),n.jsxs("div",{className:p,children:[n.jsxs("span",{children:[n.jsx(te,{})," ",fe(he)]}),n.jsxs("span",{children:[n.jsx(Y,{})," ",xe," ",1===xe?"Passenger":"Passengers"]})]})]}),n.jsx(t,{to:"/",className:j,children:"Modify"})]}),ue.length>0&&n.jsxs("div",{className:m,children:[n.jsxs("div",{className:v,children:[n.jsx("label",{children:"Sort by:"}),n.jsxs("select",{value:ge,onChange:e=>ye(e.target.value),children:[n.jsx("option",{value:"departure",children:"Departure Time"}),n.jsx("option",{value:"price",children:"Price (Low to High)"}),n.jsx("option",{value:"duration",children:"Duration"})]})]}),Ce.length>1&&n.jsxs("div",{className:v,children:[n.jsx("label",{children:"Bus Type:"}),n.jsxs("select",{value:ke,onChange:e=>we(e.target.value),children:[n.jsx("option",{value:"all",children:"All Types"}),Ce.map(e=>n.jsx("option",{value:e,children:e},e))]})]}),n.jsxs("div",{className:g,children:[Ne.length," ",1===Ne.length?"bus":"buses"," found"]})]}),n.jsx("div",{className:y,children:pe?n.jsxs("div",{className:k,children:[n.jsx("div",{className:w}),n.jsx("p",{children:"Searching for available buses..."})]}):me?n.jsxs("div",{className:N,children:[n.jsx(ne,{}),n.jsx("h2",{children:"Oops! Something went wrong"}),n.jsx("p",{children:me}),n.jsx("button",{onClick:()=>ee("/home"),children:"Back to Search"})]}):0===Ne.length?n.jsxs("div",{className:b,children:[n.jsx(X,{}),n.jsx("h2",{children:"No buses found"}),n.jsxs("p",{children:["No buses available from ",de," to ",ce," on ",fe(he),". Try a different date or route."]}),n.jsx("button",{onClick:()=>ee("/home"),children:"Search Again"})]}):n.jsx("div",{className:f,children:Ne.map(e=>{var s,i,a,r,t,l,o;return e.available_seats,n.jsxs("div",{className:L,children:[n.jsxs("div",{className:C,children:[n.jsxs("div",{className:B,children:[n.jsxs("div",{className:S,children:[n.jsx("span",{className:M,children:be(e.departure_time)}),n.jsx("span",{className:W,children:de})]}),n.jsxs("div",{className:D,children:[n.jsxs("div",{className:T,children:[n.jsx("div",{className:P}),n.jsx("div",{className:$}),n.jsx(X,{}),n.jsx("div",{className:$}),n.jsx("div",{className:P})]}),n.jsx("span",{children:Le(null==(s=e.routes)?void 0:s.duration_minutes)})]}),n.jsxs("div",{className:S,children:[n.jsx("span",{className:M,children:e.arrival_time?be(e.arrival_time):"~"+be(new Date(new Date(e.departure_time).getTime()+6e4*((null==(i=e.routes)?void 0:i.duration_minutes)||0)))}),n.jsx("span",{className:W,children:ce})]})]}),n.jsxs("div",{className:I,children:[n.jsx("div",{className:A,children:(null==(a=e.buses)?void 0:a.bus_name)||"Standard Bus"}),n.jsx("div",{className:H,children:(null==(r=e.buses)?void 0:r.bus_type)||"standard"}),(null==(t=e.buses)?void 0:t.amenities)&&e.buses.amenities.length>0&&n.jsx("div",{className:E,children:e.buses.amenities.filter(e=>e&&(e=>{const s=(e||"").toLowerCase().trim();return["wifi","ac","aircon","air conditioning","power","usb","charging","charging port","charging_port","charging-port"].includes(s)})(e)).map(e=>{const s=n.jsx(le,{type:e});return s?n.jsx("span",{className:O,title:e,children:s},e):null}).filter(Boolean)})]}),n.jsx("div",{className:R,children:n.jsxs("span",{className:`${q} ${e.available_seats<=5?F:""}`,children:[e.available_seats," ",1===e.available_seats?"seat":"seats"," left"]})}),n.jsxs("div",{className:G,children:[n.jsxs("div",{className:U,children:[n.jsx("span",{className:V,children:(o=e.price,`P${o}`)}),n.jsx("span",{className:Z,children:"per person"})]}),n.jsxs("button",{className:z,type:"button","data-trip-id":e.id,onClick:s=>{s.stopPropagation(),(e=>{ae({id:e.id,origin:de,destination:ce,date:he,price:e.price,departure_time:e.departure_time,arrival_time:e.arrival_time,bus:e.buses,route:e.routes,available_seats:e.available_seats}),ee(`/booking/seats/${e.id}?passengers=${xe}`)})(e)},disabled:e.available_seats<xe,children:["Select",n.jsx(re,{style:{pointerEvents:"none"}})]})]})]}),n.jsx("div",{className:J,children:n.jsx(d,{routeId:(null==(l=e.routes)?void 0:l.id)||e.id,tripId:e.id,trip:e,route:e.routes||{origin:de,destination:ce,origin_lat:null,origin_lng:null,destination_lat:null,destination_lng:null}})}),e.available_seats<=5&&e.available_seats>=xe&&n.jsxs("div",{className:K,children:["⚡ Only ",e.available_seats," seats remaining - Book now!"]})]},e.id)})})})]})}export{oe as default};
