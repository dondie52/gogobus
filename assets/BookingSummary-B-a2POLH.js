import{j as e,u as s,k as a,o as t,R as i}from"./index-DVEiCBCW.js";import{B as n}from"./Button-CGyLQJNo.js";import{s as l}from"./Booking.module-aEmucKHr.js";const c="_priceBreakdown_izwfs_1",r="_priceRow_izwfs_17",o="_total_izwfs_26",d="_divider_izwfs_33",h=({basePrice:s,seatCount:a,totalPrice:t})=>e.jsxs("div",{className:c,children:[e.jsx("h2",{children:"Price Breakdown"}),e.jsxs("div",{className:r,children:[e.jsx("span",{children:"Base Price (per seat)"}),e.jsxs("span",{children:["P",s.toFixed(2)]})]}),e.jsxs("div",{className:r,children:[e.jsxs("span",{children:["Seats (",a,")"]}),e.jsxs("span",{children:["× ",a]})]}),e.jsxs("div",{className:r,children:[e.jsx("span",{children:"Service Fee"}),e.jsx("span",{children:"P0.00"})]}),e.jsx("div",{className:d}),e.jsxs("div",{className:`${r} ${o}`,children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["P",t.toFixed(2)]})]})]}),m=()=>{const c=s(),r=a(),{selectedRoute:o,selectedSeats:d,passengerDetails:m}=t();i.useEffect(()=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:11",message:"BookingSummary render - context data check",data:{hasSelectedRoute:!!o,selectedRouteId:null==o?void 0:o.id,selectedSeatsCount:null==d?void 0:d.length,passengerDetailsCount:null==m?void 0:m.length,currentPath:r.pathname},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"F"})}).catch(()=>{})},[o,d,m,r.pathname]);if(!o||!d||0===d.length)return fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:22",message:"Redirecting due to missing route/seats",data:{hasSelectedRoute:!!o,selectedSeatsCount:null==d?void 0:d.length,redirectTarget:"/booking/seat-selection"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{}),c("/booking/seat-selection"),null;if(!m||0===m.length||m.length!==d.length)return fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:27",message:"Redirecting due to missing passenger details",data:{passengerDetailsCount:null==m?void 0:m.length,selectedSeatsCount:null==d?void 0:d.length,redirectTarget:"/booking/passenger-details"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{}),c("/booking/passenger-details"),null;const x=o.price*d.length,p=e=>{if(!e)return"N/A";try{const s=new Date(e),a=s.toLocaleDateString("en-BW",{day:"numeric",month:"short",year:"numeric"});return`${a} • ${s.toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!0})}`}catch(s){return e}};return e.jsxs("div",{className:l.bookingScreen,children:[e.jsxs("div",{className:l.bookingHeader,children:[e.jsx("button",{className:l.backButton,onClick:()=>{if(null==o?void 0:o.id){const e=d.length||m.length||1;c(`/booking/seats/${o.id}?passengers=${e}`)}else window.history.length>1?c(-1):c("/home")},children:"← Back"}),e.jsx("h1",{children:"Booking Summary"})]}),e.jsxs("div",{className:l.bookingContent,children:[e.jsxs("div",{className:l.summarySection,children:[e.jsx("h2",{children:"Trip Details"}),e.jsxs("div",{className:l.tripCard,children:[e.jsxs("div",{className:l.routeTimeline,children:[e.jsxs("div",{className:l.timelinePoint,children:[e.jsx("div",{className:l.timelineDot,children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:e.jsx("circle",{cx:"6",cy:"6",r:"6"})})}),e.jsxs("div",{className:l.timelineContent,children:[e.jsx("span",{className:l.timeLabel,children:p(o.departure_time)}),e.jsx("span",{className:l.locationName,children:o.origin}),o.origin_station&&e.jsx("span",{className:l.stationName,children:o.origin_station})]})]}),e.jsx("div",{className:l.timelineLine,children:e.jsxs("div",{className:l.durationBadge,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]}),e.jsx("span",{children:o.duration})]})}),e.jsxs("div",{className:l.timelinePoint,children:[e.jsx("div",{className:`${l.timelineDot} ${l.destination}`,children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:e.jsx("circle",{cx:"6",cy:"6",r:"6"})})}),e.jsxs("div",{className:l.timelineContent,children:[e.jsx("span",{className:l.timeLabel,children:p(o.arrival_time)}),e.jsx("span",{className:l.locationName,children:o.destination}),o.destination_station&&e.jsx("span",{className:l.stationName,children:o.destination_station})]})]})]}),e.jsxs("div",{className:l.tripMeta,children:[e.jsxs("div",{className:l.metaItem,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),e.jsxs("div",{className:l.metaContent,children:[e.jsx("span",{className:l.metaLabel,children:"Date"}),e.jsx("span",{className:l.metaValue,children:(e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}catch(s){return e}})(o.date)})]})]}),e.jsxs("div",{className:l.metaItem,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M8 6v6l4 2"}),e.jsx("path",{d:"M3 12a9 9 0 1 0 18 0 9 9 0 1 0-18 0"})]}),e.jsxs("div",{className:l.metaContent,children:[e.jsx("span",{className:l.metaLabel,children:"Duration"}),e.jsx("span",{className:l.metaValue,children:o.duration})]})]}),o.bus_type&&e.jsxs("div",{className:l.metaItem,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M8 6v6l4 2"}),e.jsx("rect",{x:"3",y:"3",width:"18",height:"14",rx:"2"}),e.jsx("path",{d:"M5 17v2"}),e.jsx("path",{d:"M19 17v2"}),e.jsx("circle",{cx:"7",cy:"14",r:"1.5"}),e.jsx("circle",{cx:"17",cy:"14",r:"1.5"})]}),e.jsxs("div",{className:l.metaContent,children:[e.jsx("span",{className:l.metaLabel,children:"Bus Type"}),e.jsx("span",{className:l.metaValue,children:o.bus_type})]})]}),o.operator&&e.jsxs("div",{className:l.metaItem,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),e.jsxs("div",{className:l.metaContent,children:[e.jsx("span",{className:l.metaLabel,children:"Operator"}),e.jsx("span",{className:l.metaValue,children:o.operator})]})]})]}),o.amenities&&o.amenities.length>0&&e.jsxs("div",{className:l.amenities,children:[e.jsx("span",{className:l.amenitiesLabel,children:"Amenities:"}),e.jsx("div",{className:l.amenitiesList,children:o.amenities.map((s,a)=>e.jsx("span",{className:l.amenityBadge,children:s},a))})]})]})]}),e.jsxs("div",{className:l.summarySection,children:[e.jsx("h2",{children:"Selected Seats"}),e.jsx("div",{className:l.seatsList,children:d.map(s=>e.jsx("span",{className:l.seatBadge,children:s},s))})]}),e.jsxs("div",{className:l.summarySection,children:[e.jsx("h2",{children:"Passengers"}),e.jsx("div",{className:l.passengersList,children:m.map((s,a)=>e.jsxs("div",{className:l.passengerItem,children:[e.jsx("div",{className:l.passengerAvatar,children:((null==s?void 0:s.fullName)||"U")[0].toUpperCase()}),e.jsxs("div",{className:l.passengerInfo,children:[e.jsx("span",{className:l.passengerName,children:(null==s?void 0:s.fullName)||"N/A"}),(null==s?void 0:s.idNumber)&&e.jsxs("span",{className:l.passengerId,children:["ID: ",s.idNumber]})]}),e.jsxs("span",{className:l.passengerSeat,children:["Seat ",(null==s?void 0:s.seatNumber)||d[a]||"N/A"]})]},a))})]}),e.jsx(h,{basePrice:o.price,seatCount:d.length,totalPrice:x}),e.jsx("div",{className:l.bookingFooter,children:e.jsx(n,{onClick:()=>{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:13",message:"handleContinue called",data:{hasSelectedRoute:!!o,selectedRouteId:null==o?void 0:o.id,selectedSeatsCount:null==d?void 0:d.length,passengerDetailsCount:null==m?void 0:m.length,currentPath:r.pathname},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{}),fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:19",message:"About to navigate to /booking/payment",data:{targetPath:"/booking/payment",currentPath:r.pathname},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),c("/booking/payment"),fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"BookingSummary.jsx:20",message:"navigate call completed",data:{targetPath:"/booking/payment"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{})},children:"Continue to Payment"})})]})]})};export{m as default};
