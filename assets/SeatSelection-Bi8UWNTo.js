import{r as e,j as s,R as a,u as n,w as i,m as l,o as c,L as t}from"./index-BY3fVUfY.js";const r={seat:"_seat_toh6b_7",seatBack:"_seatBack_toh6b_63",seatCushion:"_seatCushion_toh6b_83",seatLabel:"_seatLabel_toh6b_121",selected:"_selected_toh6b_139",checkmark:"_checkmark_toh6b_166",occupied:"_occupied_toh6b_204",occupiedIcon:"_occupiedIcon_toh6b_218",emergencyRow:"_emergencyRow_toh6b_245",maxReached:"_maxReached_toh6b_262"},o=e.memo(({seatId:e,isOccupied:a=!1,isSelected:n=!1,isEmergencyRow:i=!1,onSelect:l,onKeyDown:c,disabled:t=!1})=>{const o=[r.seat,a&&r.occupied,n&&r.selected,i&&r.emergencyRow,t&&!a&&r.maxReached].filter(Boolean).join(" ");return s.jsxs("button",{type:"button",className:o,onClick:l,onKeyDown:c,disabled:a,"aria-label":(()=>{const s=`Seat ${e}`;return a?`${s}, unavailable`:n?`${s}, selected`:i?`${s}, emergency exit row`:`${s}, available`})(),"aria-pressed":n,role:"checkbox","aria-checked":n,tabIndex:a?-1:0,children:[s.jsx("span",{className:r.seatBack,"aria-hidden":"true"}),s.jsx("span",{className:r.seatCushion,"aria-hidden":"true",children:a?s.jsxs("svg",{className:r.occupiedIcon,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("circle",{cx:"12",cy:"8",r:"4"}),s.jsx("path",{d:"M12 14c-4 0-8 2-8 4v2h16v-2c0-2-4-4-8-4z"})]}):s.jsx("span",{className:r.seatLabel,children:e})}),n&&s.jsx("span",{className:r.checkmark,"aria-hidden":"true",children:s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:s.jsx("polyline",{points:"20,6 9,17 4,12"})})})]})});o.displayName="Seat";const d="_seatMapWrapper_3lsbc_58",h="_busFrame_3lsbc_65",_="_busFront_3lsbc_96",x="_frontWindow_3lsbc_102",m="_windowGlare_3lsbc_111",j="_frontDetails_3lsbc_132",u="_driverArea_3lsbc_139",p="_steeringWheel_3lsbc_150",g="_driverLabel_3lsbc_167",b="_doorIndicator_3lsbc_175",v="_seatGrid_3lsbc_200",k="_seatRow_3lsbc_207",N="_backRow_3lsbc_225",w="_rowLabel_3lsbc_231",y="_leftSection_3lsbc_241",S="_rightSection_3lsbc_242",f="_aisle_3lsbc_247",C="_emergencyMarker_3lsbc_277",R="_emergencyLine_3lsbc_285",B="_emergencyBadge_3lsbc_296",L="_busRear_3lsbc_336",$="_rearWindow_3lsbc_341",W="_selectionSummary_3lsbc_366",M="_selectedSeatsChips_3lsbc_386",E="_seatChip_3lsbc_393",I="_removeSeat_3lsbc_418",P="_summaryTotal_3lsbc_440",D="_totalPrice_3lsbc_454",O={rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5},T=({config:n=O,selectedSeats:i=[],occupiedSeats:l=[],onSeatToggle:c,maxSelectable:t=4,pricePerSeat:r=0,currency:T="BWP"})=>{const{rows:A,seatsPerRow:K,aisleAfter:F,emergencyExitRows:G,hasBackRow:H,backRowSeats:z}={...O,...n},U=e.useMemo(()=>{const e=[];for(let s=1;s<=A;s++){const a=[],n=H&&s===A?z:K;for(let e=1;e<=n;e++){const n=`${s}${String.fromCharCode(64+e)}`;a.push({id:n,row:s,col:e,isOccupied:l.includes(n),isSelected:i.includes(n),isEmergencyRow:G.includes(s)})}e.push({rowNumber:s,seats:a,isEmergencyRow:G.includes(s),isBackRow:H&&s===A})}return e},[A,K,H,z,l,i,G]),V=e.useCallback(e=>{if(l.includes(e))return;!i.includes(e)&&i.length>=t||null==c||c(e)},[l,i,t,c]),Y=e.useCallback((e,s)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),V(s))},[V]);return s.jsxs("div",{className:d,children:[s.jsxs("div",{className:h,children:[s.jsxs("div",{className:_,children:[s.jsx("div",{className:x,children:s.jsx("div",{className:m})}),s.jsxs("div",{className:j,children:[s.jsxs("div",{className:b,children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("rect",{x:"3",y:"2",width:"18",height:"20",rx:"2"}),s.jsx("path",{d:"M12 2v20"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor"})]}),s.jsx("span",{children:"Entry"})]}),s.jsxs("div",{className:u,children:[s.jsx("div",{className:p,children:s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("circle",{cx:"12",cy:"12",r:"9"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 3v6M12 15v6M3 12h6M15 12h6"})]})}),s.jsx("span",{className:g,children:"Driver"})]})]})]}),s.jsx("div",{className:v,role:"group","aria-label":"Bus seat selection",children:U.map(({rowNumber:e,seats:n,isEmergencyRow:l,isBackRow:c})=>s.jsxs(a.Fragment,{children:[l&&s.jsxs("div",{className:C,children:[s.jsx("div",{className:R}),s.jsxs("div",{className:B,children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),s.jsx("polyline",{points:"16,17 21,12 16,7"}),s.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),s.jsx("span",{children:"Emergency Exit"})]}),s.jsx("div",{className:R})]}),s.jsxs("div",{className:`${k} ${c?N:""}`,role:"row","aria-label":`Row ${e}`,children:[s.jsx("span",{className:w,children:e}),s.jsx("div",{className:y,children:n.slice(0,c?Math.ceil(z/2):F).map(e=>s.jsx(o,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>V(e.id),onKeyDown:s=>Y(s,e.id),disabled:e.isOccupied||!e.isSelected&&i.length>=t},e.id))}),!c&&s.jsx("div",{className:f,"aria-hidden":"true"}),s.jsx("div",{className:S,children:n.slice(c?Math.ceil(z/2):F).map(e=>s.jsx(o,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>V(e.id),onKeyDown:s=>Y(s,e.id),disabled:e.isOccupied||!e.isSelected&&i.length>=t},e.id))}),s.jsx("span",{className:w,children:e})]})]},e))}),s.jsx("div",{className:L,children:s.jsx("div",{className:$})})]}),i.length>0&&s.jsxs("div",{className:W,children:[s.jsx("div",{className:M,children:i.map(e=>s.jsxs("span",{className:E,children:[e,s.jsx("button",{type:"button",className:I,onClick:()=>V(e),"aria-label":`Remove seat ${e}`,children:"×"})]},e))}),s.jsxs("div",{className:P,children:[s.jsxs("span",{children:[i.length," seat",1!==i.length?"s":""]}),s.jsxs("span",{className:D,children:[T," ",(i.length*r).toLocaleString()]})]})]})]})},A="_seatSelectionPage_a5nms_33",K="_header_a5nms_47",F="_backBtn_a5nms_59",G="_headerContent_a5nms_84",H="_title_a5nms_89",z="_subtitle_a5nms_97",U="_routeCard_a5nms_107",V="_routeInfo_a5nms_115",Y="_origin_a5nms_123",q="_destination_a5nms_124",J="_arrow_a5nms_131",Q="_tripMeta_a5nms_148",X="_metaItem_a5nms_156",Z="_passengerSelector_a5nms_175",ee="_passengerLabel_a5nms_184",se="_passengerControls_a5nms_200",ae="_passengerBtn_a5nms_207",ne="_passengerInput_a5nms_244",ie="_legend_a5nms_280",le="_legendItem_a5nms_293",ce="_legendBox_a5nms_299",te="_available_a5nms_309",re="_selected_a5nms_314",oe="_taken_a5nms_327",de="_mainContent_a5nms_352",he="_footer_a5nms_361",_e="_priceInfo_a5nms_377",xe="_seatCount_a5nms_383",me="_totalPrice_a5nms_388",je="_continueBtn_a5nms_395",ue=()=>{const a=n(),{tripId:r}=i(),[o,d]=l(),{selectedRoute:h,selectedSeats:_,setSelectedSeats:x}=c(),[m,j]=e.useState(!0),[u,p]=e.useState([]),g=parseInt(o.get("passengers")||"1"),[b,v]=e.useState(g);e.useEffect(()=>{const e=setTimeout(()=>{j(!1)},500);return()=>clearTimeout(e)},[]),e.useEffect(()=>{h||a("/home")},[h,a]),e.useEffect(()=>{if(o.get("passengers")!==b.toString()){const e=new URLSearchParams(o);e.set("passengers",b.toString()),d(e,{replace:!0})}},[b,o,d]),e.useEffect(()=>{_.length>b&&x(e=>e.slice(0,b))},[b,_.length,x]);const k=e=>{e>=1&&e<=10&&v(e)};if(m)return s.jsx("div",{className:A,children:s.jsx(t,{size:"large"})});if(!h)return null;const N=_.length*(h.price||0);return s.jsxs("div",{className:A,children:[s.jsxs("header",{className:K,children:[s.jsx("button",{type:"button",className:F,onClick:()=>a(-1),"aria-label":"Go back",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M19 12H5"}),s.jsx("polyline",{points:"12 19 5 12 12 5"})]})}),s.jsxs("div",{className:G,children:[s.jsx("h1",{className:H,children:"Select Your Seats"}),s.jsx("p",{className:z,children:0===_.length?`Select ${b} seat${b>1?"s":""} for ${b} passenger${b>1?"s":""}`:b-_.length>0?`${_.length} of ${b} seats selected`:"All seats selected"})]})]}),s.jsxs("div",{className:U,children:[s.jsxs("div",{className:V,children:[s.jsx("span",{className:Y,children:h.origin}),s.jsx("div",{className:J,children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})}),s.jsx("span",{className:q,children:h.destination})]}),s.jsxs("div",{className:Q,children:[s.jsxs("div",{className:X,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),s.jsx("span",{children:(w=h.date,w?new Date(w).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}):"")})]}),s.jsxs("div",{className:X,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),s.jsx("span",{children:(e=>e?new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--")(h.departure_time)})]})]}),s.jsxs("div",{className:Z,children:[s.jsxs("label",{className:ee,children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),s.jsx("span",{children:"Number of Passengers"})]}),s.jsxs("div",{className:se,children:[s.jsx("button",{type:"button",className:ae,onClick:()=>k(b-1),disabled:b<=1,"aria-label":"Decrease passengers",children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),s.jsx("input",{type:"number",min:"1",max:"10",value:b,onChange:e=>{const s=parseInt(e.target.value)||1;k(Math.max(1,Math.min(10,s)))},className:ne,"aria-label":"Number of passengers"}),s.jsx("button",{type:"button",className:ae,onClick:()=>k(b+1),disabled:b>=10,"aria-label":"Increase passengers",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]})]}),s.jsxs("div",{className:ie,children:[s.jsxs("div",{className:le,children:[s.jsx("div",{className:`${ce} ${te}`}),s.jsx("span",{children:"Available"})]}),s.jsxs("div",{className:le,children:[s.jsx("div",{className:`${ce} ${re}`}),s.jsx("span",{children:"Selected"})]}),s.jsxs("div",{className:le,children:[s.jsx("div",{className:`${ce} ${oe}`}),s.jsx("span",{children:"Taken"})]})]}),s.jsx("main",{className:de,children:s.jsx(T,{selectedSeats:_,occupiedSeats:u,onSeatToggle:e=>{x(s=>s.includes(e)?s.filter(s=>s!==e):s.length>=b?s:[...s,e])},maxSelectable:b,pricePerSeat:h.price||0,currency:"BWP",config:{rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5}})}),s.jsxs("div",{className:he,children:[s.jsxs("div",{className:_e,children:[s.jsx("span",{className:xe,children:0===_.length?"No seats selected":`${_.length} seat${_.length>1?"s":""} × BWP ${(h.price||0).toLocaleString()}`}),s.jsx("span",{className:me,children:0===_.length?"BWP 0":`BWP ${N.toLocaleString()}`})]}),s.jsxs("button",{type:"button",className:je,onClick:()=>{0!==_.length?a("/booking/passenger-details"):alert("Please select at least one seat")},disabled:0===_.length,children:["Continue",s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]});var w};export{ue as default};
