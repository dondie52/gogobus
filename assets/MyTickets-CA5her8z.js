import{j as e,u as t,m as a,a as s,r as i,L as n,q as c,c as l}from"./index-gc_mrg1P.js";const r={ticketCard:"_ticketCard_1jltu_1",ticketHeader:"_ticketHeader_1jltu_16",companyInfo:"_companyInfo_1jltu_25",companyLogo:"_companyLogo_1jltu_31",companyName:"_companyName_1jltu_35",statusBadge:"_statusBadge_1jltu_42",confirmed:"_confirmed_1jltu_51",cancelled:"_cancelled_1jltu_56",pending:"_pending_1jltu_61",ticketRoute:"_ticketRoute_1jltu_66",routePoint:"_routePoint_1jltu_76",city:"_city_1jltu_83",time:"_time_1jltu_90",routeLine:"_routeLine_1jltu_96",arrow:"_arrow_1jltu_104",duration:"_duration_1jltu_110",ticketFooter:"_ticketFooter_1jltu_116",ticketDate:"_ticketDate_1jltu_124",ticketPrice:"_ticketPrice_1jltu_125",dateLabel:"_dateLabel_1jltu_131",priceLabel:"_priceLabel_1jltu_132",dateValue:"_dateValue_1jltu_138",priceValue:"_priceValue_1jltu_145"},o=({booking:t,onClick:a})=>{var s;const i=t.schedule||{},n=i.route||{},c=(i.bus||{}).company||{},l=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return e}};return e.jsxs("div",{className:r.ticketCard,onClick:a,children:[e.jsxs("div",{className:r.ticketHeader,children:[e.jsxs("div",{className:r.companyInfo,children:[e.jsx("span",{className:r.companyLogo,children:c.logo||"ðŸšŒ"}),e.jsx("span",{className:r.companyName,children:c.name||"Bus Company"})]}),e.jsx("div",{className:`${r.statusBadge} ${r[t.status]}`,children:t.status||"confirmed"})]}),e.jsxs("div",{className:r.ticketRoute,children:[e.jsxs("div",{className:r.routePoint,children:[e.jsx("span",{className:r.city,children:n.origin||"Origin"}),e.jsx("span",{className:r.time,children:l(i.departure_time)})]}),e.jsxs("div",{className:r.routeLine,children:[e.jsx("span",{className:r.arrow,children:"â†’"}),e.jsx("span",{className:r.duration,children:i.duration||"N/A"})]}),e.jsxs("div",{className:r.routePoint,children:[e.jsx("span",{className:r.city,children:n.destination||"Destination"}),e.jsx("span",{className:r.time,children:l(i.arrival_time)})]})]}),e.jsxs("div",{className:r.ticketFooter,children:[e.jsxs("div",{className:r.ticketDate,children:[e.jsx("span",{className:r.dateLabel,children:"Date"}),e.jsx("span",{className:r.dateValue,children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})(i.departure_time||t.created_at)})]}),e.jsxs("div",{className:r.ticketPrice,children:[e.jsx("span",{className:r.priceLabel,children:"Total"}),e.jsxs("span",{className:r.priceValue,children:["P",(null==(s=t.total_price)?void 0:s.toFixed(2))||"0.00"]})]})]})]})},d="_ticketTabs_16owj_1",_="_tab_16owj_9",u="_active_16owj_28",m=({activeTab:t,onTabChange:a})=>e.jsxs("div",{className:d,children:[e.jsx("button",{className:`${_} ${"upcoming"===t?u:""}`,onClick:()=>a("upcoming"),children:"Upcoming"}),e.jsx("button",{className:`${_} ${"past"===t?u:""}`,onClick:()=>a("past"),children:"Past"})]}),j="_myTicketsScreen_nfgjq_1",p="_myTicketsHeader_nfgjq_7",h="_homeButton_nfgjq_16",g="_loadingContainer_nfgjq_48",x="_errorMessage_nfgjq_55",k="_emptyState_nfgjq_64",N="_emptyIcon_nfgjq_73",v="_ticketsList_nfgjq_91",y=()=>{const r=t(),[d,_]=a(),{user:u}=s(),[y,f]=i.useState([]),[b,L]=i.useState(!0),[w,C]=i.useState(()=>"past"===d.get("tab")?"past":"upcoming"),[D,P]=i.useState("");i.useEffect(()=>{(async()=>{if(null==u?void 0:u.id){L(!0);try{const e=await c.getUserBookings(u.id);f(e)}catch(e){l("Failed to load bookings",e),P("Failed to load tickets. Please try again.")}finally{L(!1)}}})()},[u]);const S=y.filter(e=>{var t,a;if("upcoming"===w){return new Date((null==(t=e.schedule)?void 0:t.departure_time)||e.created_at)>=new Date&&"cancelled"!==e.status}return new Date((null==(a=e.schedule)?void 0:a.departure_time)||e.created_at)<new Date||"cancelled"===e.status});return b?e.jsx("div",{className:g,children:e.jsx(n,{size:"large"})}):e.jsxs("div",{className:j,children:[e.jsxs("div",{className:p,children:[e.jsx("button",{className:h,onClick:()=>r("/home"),"aria-label":"Go to home",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),e.jsx("h1",{children:"My Tickets"})]}),e.jsx(m,{activeTab:w,onTabChange:e=>{C(e);const t=new URLSearchParams(d);"past"===e?t.set("tab","past"):t.delete("tab"),_(t,{replace:!0})}}),D?e.jsx("div",{className:x,children:D}):0===S.length?e.jsxs("div",{className:k,children:[e.jsx("div",{className:N,children:"ðŸŽ«"}),e.jsxs("h3",{children:["No ","upcoming"===w?"upcoming":"past"," tickets"]}),e.jsx("p",{children:"upcoming"===w?"You don't have any upcoming trips":"You don't have any past trips"})]}):e.jsx("div",{className:v,children:S.map(t=>e.jsx(o,{booking:t,onClick:()=>{return e=t.id,void r(`/tickets/${e}`);var e}},t.id))})]})};export{y as default};
