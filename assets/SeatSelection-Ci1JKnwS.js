import{r as e,j as s,u as a,w as n,m as i,o as t,L as r}from"./index-DhavfF0O.js";const l={seat:"_seat_toh6b_7",seatBack:"_seatBack_toh6b_63",seatCushion:"_seatCushion_toh6b_83",seatLabel:"_seatLabel_toh6b_121",selected:"_selected_toh6b_139",checkmark:"_checkmark_toh6b_166",occupied:"_occupied_toh6b_204",occupiedIcon:"_occupiedIcon_toh6b_218",emergencyRow:"_emergencyRow_toh6b_245",maxReached:"_maxReached_toh6b_262"},c=e.memo(({seatId:e,isOccupied:a=!1,isSelected:n=!1,isEmergencyRow:i=!1,onSelect:t,onKeyDown:r,disabled:c=!1})=>{const o=[l.seat,a&&l.occupied,n&&l.selected,i&&l.emergencyRow,c&&!a&&l.maxReached].filter(Boolean).join(" ");return s.jsxs("button",{type:"button",className:o,onClick:t,onKeyDown:r,disabled:a,"aria-label":(()=>{const s=`Seat ${e}`;return a?`${s}, unavailable`:n?`${s}, selected`:i?`${s}, emergency exit row`:`${s}, available`})(),"aria-pressed":n,role:"checkbox","aria-checked":n,tabIndex:a?-1:0,children:[s.jsx("span",{className:l.seatBack,"aria-hidden":"true"}),s.jsx("span",{className:l.seatCushion,"aria-hidden":"true",children:a?s.jsxs("svg",{className:l.occupiedIcon,viewBox:"0 0 24 24",fill:"currentColor",children:[s.jsx("circle",{cx:"12",cy:"8",r:"4"}),s.jsx("path",{d:"M12 14c-4 0-8 2-8 4v2h16v-2c0-2-4-4-8-4z"})]}):s.jsx("span",{className:l.seatLabel,children:e})}),n&&s.jsx("span",{className:l.checkmark,"aria-hidden":"true",children:s.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:s.jsx("polyline",{points:"20,6 9,17 4,12"})})})]})});c.displayName="Seat";const o="_seatMapWrapper_jurm6_58",d="_busFrame_jurm6_65",_="_busFront_jurm6_96",h="_frontWindow_jurm6_102",m="_windowGlare_jurm6_111",x="_frontDetails_jurm6_132",u="_driverArea_jurm6_139",j="_steeringWheel_jurm6_150",p="_driverLabel_jurm6_167",g="_doorIndicator_jurm6_175",v="_seatGrid_jurm6_200",k="_seatRow_jurm6_208",w="_backRow_jurm6_228",b="_rowLabel_jurm6_234",y="_emergencyRowLabel_jurm6_244",N="_tooltipVisible_jurm6_336",S="_leftSection_jurm6_343",f="_rightSection_jurm6_344",C="_aisle_jurm6_349",R="_emergencyRow_jurm6_244",$="_emergencyExitBadge_jurm6_387",B="_emergencyExitIcon_jurm6_425",L="_busRear_jurm6_519",E="_rearWindow_jurm6_524",W="_selectionSummary_jurm6_549",M="_selectedSeatsChips_jurm6_569",P="_seatChip_jurm6_576",I="_removeSeat_jurm6_601",T="_summaryTotal_jurm6_623",D="_totalPrice_jurm6_637",O={rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5},A=({config:a=O,selectedSeats:n=[],occupiedSeats:i=[],onSeatToggle:t,maxSelectable:r=4,pricePerSeat:l=0,currency:A="BWP"})=>{const{rows:K,seatsPerRow:G,aisleAfter:z,emergencyExitRows:F,hasBackRow:H,backRowSeats:U}={...O,...a},V=e.useMemo(()=>{const e=[];for(let s=1;s<=K;s++){const a=[],t=H&&s===K?U:G;for(let e=1;e<=t;e++){const t=`${s}${String.fromCharCode(64+e)}`;a.push({id:t,row:s,col:e,isOccupied:i.includes(t),isSelected:n.includes(t),isEmergencyRow:F.includes(s)})}e.push({rowNumber:s,seats:a,isEmergencyRow:F.includes(s),isBackRow:H&&s===K})}return e},[K,G,H,U,i,n,F]),Y=e.useCallback(e=>{if(i.includes(e))return;!n.includes(e)&&n.length>=r||null==t||t(e)},[i,n,r,t]),q=e.useCallback((e,s)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),Y(s))},[Y]),[J,Q]=e.useState(null),X=e.useCallback((e,s)=>{e.preventDefault(),e.stopPropagation(),Q(s),setTimeout(()=>{Q(null)},3e3)},[]),Z=e.useCallback(e=>{e.stopPropagation()},[]),ee=e.useCallback((e,s)=>{e.stopPropagation(),J===s?Q(null):(Q(s),setTimeout(()=>{Q(null)},3e3))},[J]);return s.jsxs("div",{className:o,children:[s.jsxs("div",{className:d,children:[s.jsxs("div",{className:_,children:[s.jsx("div",{className:h,children:s.jsx("div",{className:m})}),s.jsxs("div",{className:x,children:[s.jsxs("div",{className:g,children:[s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("rect",{x:"3",y:"2",width:"18",height:"20",rx:"2"}),s.jsx("path",{d:"M12 2v20"}),s.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor"})]}),s.jsx("span",{children:"Entry"})]}),s.jsxs("div",{className:u,children:[s.jsx("div",{className:j,children:s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[s.jsx("circle",{cx:"12",cy:"12",r:"9"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 3v6M12 15v6M3 12h6M15 12h6"})]})}),s.jsx("span",{className:p,children:"Driver"})]})]})]}),s.jsx("div",{className:v,role:"group","aria-label":"Bus seat selection",children:V.map(({rowNumber:e,seats:a,isEmergencyRow:i,isBackRow:t})=>{const l=a.slice(0,t?Math.ceil(U/2):z),o=a.slice(t?Math.ceil(U/2):z);return s.jsxs("div",{className:`${k} ${t?w:""} ${i?R:""}`,role:"row","aria-label":`Row ${e}${i?", emergency exit row":""}`,children:[i&&s.jsxs("div",{className:$,"aria-label":"Emergency exit row",children:[s.jsx("span",{className:B,children:"⚠"}),s.jsx("span",{children:"Emergency Exit"})]}),s.jsx("span",{className:`${b} ${i?y:""} ${i&&J===e?N:""}`,title:i?"Emergency exit":void 0,"data-tooltip":i?"Emergency exit":void 0,onTouchStart:i?s=>X(s,e):void 0,onTouchEnd:i?Z:void 0,children:e}),s.jsx("div",{className:S,children:l.map(e=>s.jsx(c,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>Y(e.id),onKeyDown:s=>q(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=r},e.id))}),!t&&s.jsx("div",{className:C,"aria-hidden":"true"}),s.jsx("div",{className:f,children:o.map(e=>s.jsx(c,{seatId:e.id,isOccupied:e.isOccupied,isSelected:e.isSelected,isEmergencyRow:e.isEmergencyRow,onSelect:()=>Y(e.id),onKeyDown:s=>q(s,e.id),disabled:e.isOccupied||!e.isSelected&&n.length>=r},e.id))}),s.jsx("span",{className:`${b} ${i?y:""} ${i&&J===e?N:""}`,title:i?"Emergency exit":void 0,"data-tooltip":i?"Emergency exit":void 0,onTouchStart:i?s=>X(s,e):void 0,onTouchEnd:i?Z:void 0,onClick:i?s=>ee(s,e):void 0,children:e})]},e)})}),s.jsx("div",{className:L,children:s.jsx("div",{className:E})})]}),n.length>0&&s.jsxs("div",{className:W,children:[s.jsx("div",{className:M,children:n.map(e=>s.jsxs("span",{className:P,children:[e,s.jsx("button",{type:"button",className:I,onClick:()=>Y(e),"aria-label":`Remove seat ${e}`,children:"×"})]},e))}),s.jsxs("div",{className:T,children:[s.jsxs("span",{children:[n.length," seat",1!==n.length?"s":""]}),s.jsxs("span",{className:D,children:[A," ",(n.length*l).toLocaleString()]})]})]})]})},K="_seatSelectionPage_a5nms_33",G="_header_a5nms_47",z="_backBtn_a5nms_59",F="_headerContent_a5nms_84",H="_title_a5nms_89",U="_subtitle_a5nms_97",V="_routeCard_a5nms_107",Y="_routeInfo_a5nms_115",q="_origin_a5nms_123",J="_destination_a5nms_124",Q="_arrow_a5nms_131",X="_tripMeta_a5nms_148",Z="_metaItem_a5nms_156",ee="_passengerSelector_a5nms_175",se="_passengerLabel_a5nms_184",ae="_passengerControls_a5nms_200",ne="_passengerBtn_a5nms_207",ie="_passengerInput_a5nms_244",te="_legend_a5nms_280",re="_legendItem_a5nms_293",le="_legendBox_a5nms_299",ce="_available_a5nms_309",oe="_selected_a5nms_314",de="_taken_a5nms_327",_e="_mainContent_a5nms_352",he="_footer_a5nms_361",me="_priceInfo_a5nms_377",xe="_seatCount_a5nms_383",ue="_totalPrice_a5nms_388",je="_continueBtn_a5nms_395",pe=()=>{const l=a(),{tripId:c}=n(),[o,d]=i(),{selectedRoute:_,selectedSeats:h,setSelectedSeats:m}=t(),[x,u]=e.useState(!0),[j,p]=e.useState([]),g=parseInt(o.get("passengers")||"1"),[v,k]=e.useState(g);e.useEffect(()=>{const e=setTimeout(()=>{u(!1)},500);return()=>clearTimeout(e)},[]),e.useEffect(()=>{_||l("/home")},[_,l]),e.useEffect(()=>{if(o.get("passengers")!==v.toString()){const e=new URLSearchParams(o);e.set("passengers",v.toString()),d(e,{replace:!0})}},[v,o,d]),e.useEffect(()=>{h.length>v&&m(e=>e.slice(0,v))},[v,h.length,m]);const w=e=>{e>=1&&e<=10&&k(e)};if(x)return s.jsx("div",{className:K,children:s.jsx(r,{size:"large"})});if(!_)return null;const b=h.length*(_.price||0);return s.jsxs("div",{className:K,children:[s.jsxs("header",{className:G,children:[s.jsx("button",{type:"button",className:z,onClick:()=>l(-1),"aria-label":"Go back",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M19 12H5"}),s.jsx("polyline",{points:"12 19 5 12 12 5"})]})}),s.jsxs("div",{className:F,children:[s.jsx("h1",{className:H,children:"Select Your Seats"}),s.jsx("p",{className:U,children:0===h.length?`Select ${v} seat${v>1?"s":""} for ${v} passenger${v>1?"s":""}`:v-h.length>0?`${h.length} of ${v} seats selected`:"All seats selected"})]})]}),s.jsxs("div",{className:V,children:[s.jsxs("div",{className:Y,children:[s.jsx("span",{className:q,children:_.origin}),s.jsx("div",{className:Q,children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})}),s.jsx("span",{className:J,children:_.destination})]}),s.jsxs("div",{className:X,children:[s.jsxs("div",{className:Z,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),s.jsx("span",{children:(y=_.date,y?new Date(y).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}):"")})]}),s.jsxs("div",{className:Z,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),s.jsx("span",{children:(e=>e?new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--")(_.departure_time)})]})]}),s.jsxs("div",{className:ee,children:[s.jsxs("label",{className:se,children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),s.jsx("span",{children:"Number of Passengers"})]}),s.jsxs("div",{className:ae,children:[s.jsx("button",{type:"button",className:ne,onClick:()=>w(v-1),disabled:v<=1,"aria-label":"Decrease passengers",children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),s.jsx("input",{type:"number",min:"1",max:"10",value:v,onChange:e=>{const s=parseInt(e.target.value)||1;w(Math.max(1,Math.min(10,s)))},className:ie,"aria-label":"Number of passengers"}),s.jsx("button",{type:"button",className:ne,onClick:()=>w(v+1),disabled:v>=10,"aria-label":"Increase passengers",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]})]}),s.jsxs("div",{className:te,children:[s.jsxs("div",{className:re,children:[s.jsx("div",{className:`${le} ${ce}`}),s.jsx("span",{children:"Available"})]}),s.jsxs("div",{className:re,children:[s.jsx("div",{className:`${le} ${oe}`}),s.jsx("span",{children:"Selected"})]}),s.jsxs("div",{className:re,children:[s.jsx("div",{className:`${le} ${de}`}),s.jsx("span",{children:"Taken"})]})]}),s.jsx("main",{className:_e,children:s.jsx(A,{selectedSeats:h,occupiedSeats:j,onSeatToggle:e=>{m(s=>s.includes(e)?s.filter(s=>s!==e):s.length>=v?s:[...s,e])},maxSelectable:v,pricePerSeat:_.price||0,currency:"BWP",config:{rows:10,seatsPerRow:4,aisleAfter:2,emergencyExitRows:[3,7],hasBackRow:!0,backRowSeats:5}})}),s.jsxs("div",{className:he,children:[s.jsxs("div",{className:me,children:[s.jsx("span",{className:xe,children:0===h.length?"No seats selected":`${h.length} seat${h.length>1?"s":""} × BWP ${(_.price||0).toLocaleString()}`}),s.jsx("span",{className:ue,children:0===h.length?"BWP 0":`BWP ${b.toLocaleString()}`})]}),s.jsxs("button",{type:"button",className:je,onClick:()=>{0!==h.length?l("/booking/passenger-details"):alert("Please select at least one seat")},disabled:0===h.length,children:["Continue",s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]});var y};export{pe as default};
