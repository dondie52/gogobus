const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-BQVf5zEl.js","assets/index-Cteh5ezv.js","assets/index-CruQL1Ad.css"])))=>i.map(i=>d[i]);
import{c as e,s as t,_ as s,r as n,j as a,u as i,w as r,a as o,L as l,q as c}from"./index-Cteh5ezv.js";import{B as d}from"./Button-D7ec3YZm.js";import{Q as u}from"./QRCodeDisplay-lGM-OQXY.js";import{s as h,T as x,g as _}from"./trackingService-Deqtew15.js";const m={name:"GOGOBUS",tagline:"Travel with Confidence",phone:"+267 12 345 678",email:"support@gogobus.co.bw",website:"www.gogobus.co.bw",address:"Plot 123, Main Mall, Gaborone, Botswana"},k={primary:"#1B4D4A",primaryDark:"#153D3A",accent:"#F5A623",success:"#22C55E",gray:"#64748B",lightGray:"#F1F5F9",white:"#FFFFFF",black:"#0F172A"},g=async t=>{const{default:n}=await s(async()=>{const{default:e}=await import("./jspdf.es.min-BQVf5zEl.js").then(e=>e.j);return{default:e}},__vite__mapDeps([0,1,2])),{booking_reference:a,passenger_name:i,passenger_phone:r,passenger_email:o,seat_number:l,total_amount:c,payment_status:d,payment_method:u,trips:{departure_time:h,arrival_time:x,price:_,routes:{origin:g,destination:p},buses:j}}=t,y=new n({orientation:"portrait",unit:"mm",format:[148,210]}),v=148,w=10;let b=w;const f=(e,t,s,n,a=k.lightGray,i=.5)=>{y.setDrawColor(a),y.setLineWidth(i),y.line(e,t,s,n)};((e,t,s,n,a=0)=>{y.setFillColor(n),a>0?y.roundedRect(e,b,t,s,a,a,"F"):y.rect(e,b,t,s,"F")})(0,v,35,k.primary),b=15,y.setFontSize(20),y.setTextColor(k.white),y.setFont("helvetica","bold"),y.text("GOGOBUS",w,b),b=22,y.setFontSize(8),y.setFont("helvetica","normal"),y.text(m.tagline,w,b),y.setFillColor(k.accent),y.roundedRect(108,10,30,12,2,2,"F"),y.setFontSize(7),y.setTextColor(k.white),y.setFont("helvetica","bold"),y.text("E-TICKET",123,17.5,{align:"center"}),b=45,y.setFontSize(24),y.setTextColor(k.black),y.setFont("helvetica","bold"),y.text(g.substring(0,3).toUpperCase(),25,b,{align:"center"}),y.setFontSize(9),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text(g,25,b+6,{align:"center"}),f(45,b-3,103,b-3,k.lightGray,1),y.setFillColor(k.accent),y.circle(74,b-3,4,"F"),y.setFontSize(6),y.setTextColor(k.white),y.text("BUS",74,b-1.5,{align:"center"}),y.setFontSize(24),y.setTextColor(k.black),y.setFont("helvetica","bold"),y.text(p.substring(0,3).toUpperCase(),123,b,{align:"center"}),y.setFontSize(9),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text(p,123,b+6,{align:"center"}),b=65;const N=new Date(h),F=N.toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),C=N.toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit"});y.setFillColor(k.lightGray),y.roundedRect(w,b,60,20,3,3,"F"),y.setFontSize(7),y.setTextColor(k.gray),y.text("DATE",15,b+6),y.setFontSize(11),y.setTextColor(k.black),y.setFont("helvetica","bold"),y.text(F,15,b+14),y.setFillColor(k.lightGray),y.roundedRect(78,b,60,20,3,3,"F"),y.setFontSize(7),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text("DEPARTURE",83,b+6),y.setFontSize(16),y.setTextColor(k.primary),y.setFont("helvetica","bold"),y.text(C,83,b+15),b=95;for(let e=w;e<138;e+=4)f(e,b,e+2,b,k.lightGray,.5);y.setFillColor(k.white),y.circle(0,b,5,"F"),y.circle(v,b,5,"F"),b=105,y.setFontSize(7),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text("PASSENGER",w,b),y.setFontSize(12),y.setTextColor(k.black),y.setFont("helvetica","bold"),y.text(i.toUpperCase(),w,b+6),y.setFontSize(7),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text("PHONE",w,b+15),y.setFontSize(10),y.setTextColor(k.black),y.setFont("helvetica","normal"),y.text(r||"N/A",w,b+21),y.setFontSize(7),y.setTextColor(k.gray),y.text("SEAT",108,b),y.setFillColor(k.primary),y.roundedRect(108,b+2,30,18,3,3,"F"),y.setFontSize(16),y.setTextColor(k.white),y.setFont("helvetica","bold"),y.text(l,123,b+14,{align:"center"}),b=140,y.setFontSize(7),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text("BOOKING REFERENCE",w,b),y.setFontSize(18),y.setTextColor(k.primary),y.setFont("helvetica","bold"),y.text(a,w,b+8);const S="paid"===d?k.success:k.accent;y.setFillColor(S),y.roundedRect(113,b-2,25,10,2,2,"F"),y.setFontSize(6),y.setTextColor(k.white),y.setFont("helvetica","bold"),y.text(d.toUpperCase(),125.5,b+4,{align:"center"}),b=155,y.setFillColor(k.lightGray),y.roundedRect(103,b,35,35,3,3,"F"),y.setFontSize(6),y.setTextColor(k.gray),y.text("SCAN TO",120.5,b+14,{align:"center"}),y.text("VERIFY",120.5,b+18,{align:"center"});try{const n=await(async t=>{try{const e=await s(()=>import("./browser-SFIkLt_d.js").then(e=>e.b),[]);return await e.toDataURL(JSON.stringify(t),{width:150,margin:1,color:{dark:k.primary,light:k.white}})}catch(n){return e("QR Code generation failed",n),null}})({ref:a,id:t.id,v:1});n&&y.addImage(n,"PNG",105,b+2,31,31)}catch(B){}y.setFontSize(7),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text("AMOUNT PAID",w,b+5),y.setFontSize(20),y.setTextColor(k.black),y.setFont("helvetica","bold"),y.text(`P${Number(c||_).toFixed(2)}`,w,b+14),y.setFontSize(8),y.setTextColor(k.gray),y.setFont("helvetica","normal");const T={card:"Credit/Debit Card",orange_money:"Orange Money",myzaka:"MyZaka",cash:"Cash",bank_transfer:"Bank Transfer"}[u]||u;return y.text(`via ${T}`,w,b+20),b=190,f(w,b,138,b,k.lightGray,.3),b=198,y.setFontSize(6),y.setTextColor(k.gray),y.setFont("helvetica","normal"),y.text(m.phone,w,b),y.text(m.email,74,b,{align:"center"}),y.text(m.website,138,b,{align:"right"}),b=203,y.setFontSize(5),y.text("Please arrive at the station 30 minutes before departure. This ticket is non-transferable.",74,b,{align:"center"}),y},p=async t=>{try{const e=await g(t),s=`GOGOBUS-Ticket-${t.booking_reference}.pdf`;return e.save(s),{success:!0,filename:s}}catch(s){return e("PDF generation error",s),{success:!1,error:s.message}}},j=async t=>{try{const e=await g(t);return{success:!0,blob:e.output("blob")}}catch(s){return e("PDF blob error",s),{success:!1,error:s.message}}},y=async t=>{try{const e=await g(t);return e.autoPrint(),window.open(e.output("bloburl"),"_blank"),{success:!0}}catch(s){return e("Print error",s),{success:!1,error:s.message}}},v="_buttonGroup_1nzce_8",w="_btn_1nzce_17",b="_primary_1nzce_38",f="_secondary_1nzce_50",N="_minimalBtn_1nzce_64",F="_card_1nzce_88",C="_cardHeader_1nzce_96",S="_cardText_1nzce_110",T="_cardActions_1nzce_117",B="_errorMessage_1nzce_133",D="_errorToast_1nzce_145",z="_spinner_1nzce_177",$=()=>a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),L=()=>a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),a.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),a.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),R=()=>a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),E=()=>a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),a.jsx("polyline",{points:"22,6 12,13 2,6"})]}),P=()=>a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:z,children:a.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),G=()=>a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6 9 17l-5-5"})}),A=()=>a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]});function O({bookingData:t,variant:s="button",showPrint:i=!0,showShare:r=!0,showEmail:o=!1,className:l=""}){const[c,d]=n.useState(!1),[u,h]=n.useState(!1),[x,_]=n.useState(!1),[m,k]=n.useState(null),[g,z]=n.useState(""),O=(e,t="")=>{k(e),z(t),setTimeout(()=>{k(null),z("")},3e3)},I=async()=>{if(!c&&t){d(!0);try{const e=await p(t);if(!e.success)throw new Error(e.error);O("success")}catch(s){e("Download error",s),O("error",s.message||"Download failed")}finally{d(!1)}}},U=async()=>{if(!u&&t){h(!0);try{const e=await y(t);if(!e.success)throw new Error(e.error)}catch(s){e("Print error",s),O("error",s.message||"Print failed")}finally{h(!1)}}};return"minimal"===s?a.jsx("button",{className:`${N} ${l}`,onClick:I,disabled:c,children:c?a.jsx(P,{}):a.jsx($,{})}):"card"===s?a.jsxs("div",{className:`${F} ${l}`,children:[a.jsxs("div",{className:C,children:[a.jsx($,{}),a.jsx("span",{children:"Download Your Ticket"})]}),a.jsx("p",{className:S,children:"Get your e-ticket as a PDF file. You can print it or show it on your phone."}),a.jsxs("div",{className:T,children:[a.jsx("button",{className:`${w} ${b}`,onClick:I,disabled:c,children:c?a.jsxs(a.Fragment,{children:[a.jsx(P,{}),"Generating..."]}):"success"===m?a.jsxs(a.Fragment,{children:[a.jsx(G,{}),"Downloaded!"]}):a.jsxs(a.Fragment,{children:[a.jsx($,{}),"Download PDF"]})}),i&&a.jsxs("button",{className:`${w} ${f}`,onClick:U,disabled:u,children:[u?a.jsx(P,{}):a.jsx(L,{}),"Print"]})]}),"error"===m&&a.jsxs("div",{className:B,children:[a.jsx(A,{}),g||"Something went wrong"]})]}):a.jsxs("div",{className:`${v} ${l}`,children:[a.jsx("button",{className:`${w} ${b}`,onClick:I,disabled:c,children:c?a.jsxs(a.Fragment,{children:[a.jsx(P,{}),"Generating..."]}):"success"===m?a.jsxs(a.Fragment,{children:[a.jsx(G,{}),"Downloaded!"]}):a.jsxs(a.Fragment,{children:[a.jsx($,{}),"Download Ticket"]})}),i&&a.jsx("button",{className:`${w} ${f}`,onClick:U,disabled:u,title:"Print ticket",children:u?a.jsx(P,{}):a.jsx(L,{})}),r&&a.jsx("button",{className:`${w} ${f}`,onClick:async()=>{var s,n,a,i;if(!x&&t){_(!0);try{if(navigator.share){const e={title:`GOGOBUS Ticket - ${t.booking_reference}`,text:`My bus ticket: ${null==(n=null==(s=t.trips)?void 0:s.routes)?void 0:n.origin} â†’ ${null==(i=null==(a=t.trips)?void 0:a.routes)?void 0:i.destination}. Booking ref: ${t.booking_reference}`,url:window.location.href};if(navigator.canShare&&navigator.canShare({files:[]})){const{blob:s}=await j(t);if(s){const n=new File([s],`GOGOBUS-Ticket-${t.booking_reference}.pdf`,{type:"application/pdf"});e.files=[n]}}await navigator.share(e),O("success")}else await navigator.clipboard.writeText(window.location.href),O("success")}catch(r){"AbortError"!==r.name&&(e("Share error",r),O("error","Share failed"))}finally{_(!1)}}},disabled:x,title:"Share ticket",children:x?a.jsx(P,{}):a.jsx(R,{})}),o&&a.jsx("button",{className:`${w} ${f}`,onClick:async()=>{var e,s,n,a,i;if(!t)return;const r=encodeURIComponent(`GOGOBUS Ticket - ${t.booking_reference}`),o=encodeURIComponent(`My GOGOBUS ticket:\n\nRoute: ${null==(s=null==(e=t.trips)?void 0:e.routes)?void 0:s.origin} â†’ ${null==(a=null==(n=t.trips)?void 0:n.routes)?void 0:a.destination}\nDate: ${new Date(null==(i=t.trips)?void 0:i.departure_time).toLocaleDateString()}\nBooking Reference: ${t.booking_reference}\nSeat: ${t.seat_number}\n\nView ticket: ${window.location.href}`);window.location.href=`mailto:?subject=${r}&body=${o}`},title:"Email ticket",children:a.jsx(E,{})}),"error"===m&&a.jsxs("div",{className:D,children:[a.jsx(A,{}),g||"Something went wrong"]})]})}const I="_card_1uhx6_1",U="_header_1uhx6_14",M="_headerIcon_1uhx6_23",V="_headerTitle_1uhx6_28",H="_loadingState_1uhx6_37",W="_errorState_1uhx6_38",K="_emptyState_1uhx6_39",Q="_loadingSpinner_1uhx6_49",Y="_errorIcon_1uhx6_63",J="_emptyIcon_1uhx6_64",q="_retryButton_1uhx6_73",Z="_emptyText_1uhx6_89",X="_emptySubtext_1uhx6_97",ee="_content_1uhx6_104",te="_infoRow_1uhx6_110",se="_infoLabel_1uhx6_122",ne="_infoValue_1uhx6_129",ae="_lastUpdated_1uhx6_137",ie="_updateDot_1uhx6_149",re="_mapButton_1uhx6_162",oe="_mapButtonIcon_1uhx6_186",le="_mapButtonArrow_1uhx6_190";function ce(e){if(!e)return"Unknown";const t=new Date(e),s=new Date-t,n=Math.floor(s/1e3),a=Math.floor(n/60),i=Math.floor(a/60);return n<10?"Just now":n<60?`${n} sec ago`:a<60?`${a} min ago`:i<24?`${i} hr ago`:t.toLocaleDateString()}function de(e){return e?e.locationName?e.locationName:e.lat&&e.lng?`${e.lat.toFixed(4)}Â°, ${e.lng.toFixed(4)}Â°`:"Location unavailable":"Location unavailable"}function ue({routeId:e,trip:t,bookingId:s}){const r=i(),[o,l]=n.useState(null),[c,d]=n.useState(!0),[u,m]=n.useState(null),[k,g]=n.useState(null);n.useEffect(()=>{if(!e)return void d(!1);let t=!0;return async function(){try{d(!0),m(null);const s=await _(e);t&&(l(s),g((null==s?void 0:s.recorded_at)||null))}catch(s){t&&m("Failed to load tracking data")}finally{t&&d(!1)}}(),()=>{t=!1}},[e]),n.useEffect(()=>{if(!e)return;const t=h(e,e=>{l(e),g((null==e?void 0:e.recorded_at)||(new Date).toISOString())});return()=>{t()}},[e]),n.useEffect(()=>{if(!k)return;const e=setInterval(()=>{g(e=>e)},1e4);return()=>clearInterval(e)},[k]);const p=n.useCallback(()=>{r(`/tracking/${e}`)},[r,e]);return c?a.jsxs("div",{className:I,children:[a.jsxs("div",{className:U,children:[a.jsx("span",{className:M,children:"ðŸ“"}),a.jsx("h3",{className:V,children:"Live Tracking"})]}),a.jsxs("div",{className:H,children:[a.jsx("div",{className:Q}),a.jsx("span",{children:"Loading tracking data..."})]})]}):u?a.jsxs("div",{className:I,children:[a.jsxs("div",{className:U,children:[a.jsx("span",{className:M,children:"ðŸ“"}),a.jsx("h3",{className:V,children:"Live Tracking"})]}),a.jsxs("div",{className:W,children:[a.jsx("span",{className:Y,children:"âš ï¸"}),a.jsx("p",{children:u}),a.jsx("button",{className:q,onClick:()=>window.location.reload(),type:"button",children:"Retry"})]})]}):o?a.jsxs("div",{className:I,children:[a.jsxs("div",{className:U,children:[a.jsx("span",{className:M,children:"ðŸ“"}),a.jsx("h3",{className:V,children:"Live Tracking"}),o.status&&a.jsx(x,{status:o.status,size:"small"})]}),a.jsxs("div",{className:ee,children:[a.jsxs("div",{className:te,children:[a.jsx("span",{className:se,children:"Current Location"}),a.jsx("span",{className:ne,children:de(o)})]}),null!=o.speed&&a.jsxs("div",{className:te,children:[a.jsx("span",{className:se,children:"Speed"}),a.jsxs("span",{className:ne,children:[Math.round(o.speed)," km/h"]})]}),a.jsxs("div",{className:te,children:[a.jsx("span",{className:se,children:"ETA"}),a.jsx("span",{className:ne,children:(null==t?void 0:t.eta)||"Estimating..."})]}),a.jsxs("div",{className:ae,children:[a.jsx("span",{className:ie}),"Last updated: ",ce(k)]})]}),a.jsxs("button",{type:"button",className:re,onClick:p,"aria-label":"Open live map view",children:[a.jsx("span",{className:oe,children:"ðŸ—ºï¸"}),"Open Live Map",a.jsx("span",{className:le,children:"â†’"})]})]}):a.jsxs("div",{className:I,children:[a.jsxs("div",{className:U,children:[a.jsx("span",{className:M,children:"ðŸ“"}),a.jsx("h3",{className:V,children:"Live Tracking"})]}),a.jsxs("div",{className:K,children:[a.jsx("span",{className:J,children:"ðŸšŒ"}),a.jsx("p",{className:Z,children:"Live tracking will be available once the bus departs."}),a.jsx("p",{className:X,children:"Check back closer to departure time."})]})]})}const he={ticketViewScreen:"_ticketViewScreen_1uky6_1",loadingContainer:"_loadingContainer_1uky6_8",errorContainer:"_errorContainer_1uky6_9",ticketViewHeader:"_ticketViewHeader_1uky6_23",backButton:"_backButton_1uky6_30",ticketViewContent:"_ticketViewContent_1uky6_54",ticketCard:"_ticketCard_1uky6_59",ticketHeader:"_ticketHeader_1uky6_66",companyInfo:"_companyInfo_1uky6_75",companyLogo:"_companyLogo_1uky6_81",companyName:"_companyName_1uky6_85",bookingRef:"_bookingRef_1uky6_93",statusBadge:"_statusBadge_1uky6_99",confirmed:"_confirmed_1uky6_108",cancelled:"_cancelled_1uky6_113",ticketRoute:"_ticketRoute_1uky6_118",routePoint:"_routePoint_1uky6_128",city:"_city_1uky6_135",time:"_time_1uky6_142",routeLine:"_routeLine_1uky6_148",arrow:"_arrow_1uky6_156",duration:"_duration_1uky6_162",ticketDetails:"_ticketDetails_1uky6_168",detailRow:"_detailRow_1uky6_172",price:"_price_1uky6_194",trackingSection:"_trackingSection_1uky6_200",ticketDownloadSection:"_ticketDownloadSection_1uky6_205",ticketActions:"_ticketActions_1uky6_210"},xe=()=>{var t,s;const{id:h}=r(),x=i(),{user:_}=o(),[m,k]=n.useState(null),[g,p]=n.useState(!0),[j,y]=n.useState(!1),[v,w]=n.useState("");n.useEffect(()=>{(async()=>{if(null==_?void 0:_.id){p(!0);try{const e=(await c.getUserBookings(_.id)).find(e=>e.id===h);e?k(e):w("Ticket not found")}catch(t){e("Failed to load booking",t),w("Failed to load ticket. Please try again.")}finally{p(!1)}}})()},[h,_]);if(g)return a.jsx("div",{className:he.loadingContainer,children:a.jsx(l,{size:"large"})});if(v||!m)return a.jsxs("div",{className:he.errorContainer,children:[a.jsx("p",{children:v||"Ticket not found"}),a.jsx(d,{onClick:()=>x("/tickets"),children:"Back to Tickets"})]});const b=m.schedule||{},f=b.route||{},N=b.bus||{},F=N.company||{},C=m?{id:m.id,booking_reference:m.booking_reference||`BK${m.id.substring(0,8).toUpperCase()}`,passenger_name:m.passenger_name||(null==(S=m.user)?void 0:S.name)||"Passenger",passenger_phone:m.passenger_phone||(null==(T=m.user)?void 0:T.phone)||"",passenger_email:m.passenger_email||(null==(B=m.user)?void 0:B.email)||"",seat_number:(null==(D=m.seats)?void 0:D[0])||m.seat_number||"N/A",total_amount:m.total_price||m.total_amount||0,payment_status:m.payment_status||m.status||"pending",payment_method:m.payment_method||"card",trips:{departure_time:b.departure_time||m.created_at,arrival_time:b.arrival_time,price:b.price||m.total_price||0,routes:{origin:f.origin||"",destination:f.destination||"",distance_km:f.distance_km,duration_minutes:f.duration_minutes},buses:N||{}}}:null;var S,T,B,D;return a.jsxs("div",{className:he.ticketViewScreen,children:[a.jsxs("div",{className:he.ticketViewHeader,children:[a.jsx("button",{className:he.backButton,onClick:()=>x("/tickets"),children:"â† Back"}),a.jsx("h1",{children:"Ticket Details"})]}),a.jsx("div",{className:he.ticketViewContent,children:a.jsxs("div",{className:he.ticketCard,children:[a.jsxs("div",{className:he.ticketHeader,children:[a.jsxs("div",{className:he.companyInfo,children:[a.jsx("span",{className:he.companyLogo,children:F.logo||"ðŸšŒ"}),a.jsxs("div",{children:[a.jsx("div",{className:he.companyName,children:F.name||"Bus Company"}),a.jsxs("div",{className:he.bookingRef,children:["Booking #",m.id]})]})]}),a.jsx("div",{className:`${he.statusBadge} ${he[m.status]}`,children:m.status||"confirmed"})]}),a.jsxs("div",{className:he.ticketRoute,children:[a.jsxs("div",{className:he.routePoint,children:[a.jsx("span",{className:he.city,children:f.origin||"Origin"}),a.jsx("span",{className:he.time,children:b.departure_time||"N/A"})]}),a.jsxs("div",{className:he.routeLine,children:[a.jsx("span",{className:he.arrow,children:"â†’"}),a.jsx("span",{className:he.duration,children:b.duration||"N/A"})]}),a.jsxs("div",{className:he.routePoint,children:[a.jsx("span",{className:he.city,children:f.destination||"Destination"}),a.jsx("span",{className:he.time,children:b.arrival_time||"N/A"})]})]}),a.jsxs("div",{className:he.ticketDetails,children:[a.jsxs("div",{className:he.detailRow,children:[a.jsx("span",{children:"Date"}),a.jsx("span",{children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})(b.departure_time||m.created_at)})]}),a.jsxs("div",{className:he.detailRow,children:[a.jsx("span",{children:"Seats"}),a.jsx("span",{children:(null==(t=m.seats)?void 0:t.join(", "))||"N/A"})]}),a.jsxs("div",{className:he.detailRow,children:[a.jsx("span",{children:"Total Price"}),a.jsxs("span",{className:he.price,children:["P",(null==(s=m.total_price)?void 0:s.toFixed(2))||"0.00"]})]})]}),a.jsx(u,{bookingId:m.id,route:f,seats:m.seats}),(null==f?void 0:f.id)&&a.jsx("div",{className:he.trackingSection,children:a.jsx(ue,{routeId:f.id,trip:m.schedule,bookingId:m.id})}),C&&a.jsx("div",{className:he.ticketDownloadSection,children:a.jsx(O,{bookingData:C,variant:"card",showPrint:!0,showShare:!0,showEmail:!1})}),"cancelled"!==m.status&&a.jsx("div",{className:he.ticketActions,children:a.jsx(d,{variant:"outline",onClick:async()=>{if(window.confirm("Are you sure you want to cancel this booking?")){y(!0);try{await c.cancelBooking(h),k(e=>({...e,status:"cancelled"})),alert("Booking cancelled successfully")}catch(t){e("Failed to cancel booking",t),alert("Failed to cancel booking. Please try again.")}finally{y(!1)}}},disabled:j,children:j?"Cancelling...":"Cancel Booking"})})]})})]})};export{xe as default};
