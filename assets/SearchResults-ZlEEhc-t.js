import{u as e,m as s,n as a,o as t,r as i,j as r,d as n,q as l,c as o}from"./index-Bt00Tcmk.js";const d="_searchPage_1pt2a_6",c="_header_1pt2a_13",h="_backBtn_1pt2a_25",x="_headerContent_1pt2a_42",u="_headerTitle_1pt2a_46",_="_headerMeta_1pt2a_53",p="_modifyBtn_1pt2a_71",j="_filters_1pt2a_88",m="_filterGroup_1pt2a_98",v="_resultsCount_1pt2a_120",g="_content_1pt2a_128",y="_loading_1pt2a_136",k="_spinner_1pt2a_141",w="_error_1pt2a_161",N="_empty_1pt2a_162",b="_tripsList_1pt2a_213",f="_tripCard_1pt2a_219",L="_tripMain_1pt2a_232",B="_tripTimes_1pt2a_242",C="_timeBlock_1pt2a_248",S="_time_1pt2a_248",M="_city_1pt2a_260",W="_duration_1pt2a_265",D="_durationLine_1pt2a_273",T="_durationDot_1pt2a_279",P="_durationDash_1pt2a_287",$="_busInfo_1pt2a_312",A="_busName_1pt2a_316",H="_busType_1pt2a_323",I="_amenities_1pt2a_330",E="_amenity_1pt2a_335",O="_seatsInfo_1pt2a_348",R="_seatsCount_1pt2a_353",q="_low_1pt2a_363",F="_priceAction_1pt2a_370",G="_price_1pt2a_370",U="_priceAmount_1pt2a_382",V="_priceLabel_1pt2a_389",Z="_selectBtn_1pt2a_394",z="_lowSeatsWarning_1pt2a_422",J=()=>r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"m12 19-7-7 7-7"}),r.jsx("path",{d:"M19 12H5"})]}),K=()=>r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M8 6v6m8-6v6M5 18v2m14-2v2M3 6h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6ZM3 6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2"}),r.jsx("circle",{cx:"7",cy:"15",r:"1"}),r.jsx("circle",{cx:"17",cy:"15",r:"1"})]}),Q=()=>r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"})]}),X=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),r.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),r.jsx("circle",{cx:"12",cy:"20",r:"1"})]}),Y=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"22"}),r.jsx("path",{d:"m20 16-4-4 4-4"}),r.jsx("path",{d:"m4 8 4 4-4 4"}),r.jsx("path",{d:"m16 4-4 4-4-4"}),r.jsx("path",{d:"m8 20 4-4 4 4"})]}),ee=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0"}),r.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"12"})]}),se=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"2",y:"7",width:"20",height:"10",rx:"2",ry:"2"}),r.jsx("line",{x1:"6",y1:"11",x2:"6",y2:"13"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"13"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"13"}),r.jsx("line",{x1:"18",y1:"11",x2:"18",y2:"13"}),r.jsx("path",{d:"M12 2v5M8 2v3M16 2v3"})]}),ae=()=>r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"m9 18 6-6-6-6"})}),te=()=>r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),ie=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),r.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),r.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),re=({type:e})=>({wifi:r.jsx(X,{}),ac:r.jsx(Y,{}),aircon:r.jsx(Y,{}),"air conditioning":r.jsx(Y,{}),power:r.jsx(ee,{}),usb:r.jsx(se,{}),charging:r.jsx(se,{}),"charging port":r.jsx(se,{}),charging_port:r.jsx(se,{}),"charging-port":r.jsx(se,{})}[(e||"").toLowerCase().trim()]||null);function ne(){const X=e(),[Y]=s(),{searchParams:ee}=a(),{setSelectedRoute:se}=t(),ne=(()=>{try{const e=window.location.hash;if(e.includes("?")){const s=e.split("?")[1];return new URLSearchParams(s)}}catch(e){}return null})(),le=((null==ne?void 0:ne.get("from"))||Y.get("from")||ee.origin||"").trim(),oe=((null==ne?void 0:ne.get("to"))||Y.get("to")||ee.destination||"").trim(),de=((null==ne?void 0:ne.get("date"))||Y.get("date")||ee.date||"").trim(),ce=parseInt((null==ne?void 0:ne.get("passengers"))||Y.get("passengers")||"1"),[he,xe]=i.useState([]),[ue,_e]=i.useState(!0),[pe,je]=i.useState(null),[me,ve]=i.useState("departure"),[ge,ye]=i.useState("all");i.useEffect(()=>{(async()=>{if(!le||!oe||!de)return je("Invalid search parameters. Please go back and try your search again."),void _e(!1);_e(!0),je(null);try{const{data:e,error:s}=await l.searchTrips({origin:le,destination:oe,date:de,passengers:ce});if(s)throw s;xe(e||[])}catch(e){o("Search error",e),je(e.message||"Failed to search trips")}finally{_e(!1)}})()},[le,oe,de,ce]);const ke=[...he].filter(e=>{var s;return"all"===ge||(null==(s=e.buses)?void 0:s.bus_type)===ge}).sort((e,s)=>{var a,t;switch(me){case"price":return e.price-s.price;case"duration":return((null==(a=e.routes)?void 0:a.duration_minutes)||0)-((null==(t=s.routes)?void 0:t.duration_minutes)||0);default:return new Date(e.departure_time)-new Date(s.departure_time)}}),we=e=>new Date(e).toLocaleTimeString("en-BW",{hour:"2-digit",minute:"2-digit"}),Ne=e=>new Date(e).toLocaleDateString("en-BW",{weekday:"short",day:"numeric",month:"short"}),be=e=>{if(!e)return"N/A";return`${Math.floor(e/60)}h ${e%60}m`},fe=[...new Set(he.map(e=>{var s;return null==(s=e.buses)?void 0:s.bus_type}).filter(Boolean))];return r.jsxs("div",{className:d,children:[r.jsxs("header",{className:c,children:[r.jsx("button",{className:h,onClick:e=>{window.history.length>1?X(-1):X("/home")},children:r.jsx(J,{})}),r.jsxs("div",{className:x,children:[r.jsxs("h1",{className:u,children:[le," → ",oe]}),r.jsxs("div",{className:_,children:[r.jsxs("span",{children:[r.jsx(ie,{})," ",Ne(de)]}),r.jsxs("span",{children:[r.jsx(Q,{})," ",ce," ",1===ce?"Passenger":"Passengers"]})]})]}),r.jsx(n,{to:"/",className:p,children:"Modify"})]}),he.length>0&&r.jsxs("div",{className:j,children:[r.jsxs("div",{className:m,children:[r.jsx("label",{children:"Sort by:"}),r.jsxs("select",{value:me,onChange:e=>ve(e.target.value),children:[r.jsx("option",{value:"departure",children:"Departure Time"}),r.jsx("option",{value:"price",children:"Price (Low to High)"}),r.jsx("option",{value:"duration",children:"Duration"})]})]}),fe.length>1&&r.jsxs("div",{className:m,children:[r.jsx("label",{children:"Bus Type:"}),r.jsxs("select",{value:ge,onChange:e=>ye(e.target.value),children:[r.jsx("option",{value:"all",children:"All Types"}),fe.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),r.jsxs("div",{className:v,children:[ke.length," ",1===ke.length?"bus":"buses"," found"]})]}),r.jsx("div",{className:g,children:ue?r.jsxs("div",{className:y,children:[r.jsx("div",{className:k}),r.jsx("p",{children:"Searching for available buses..."})]}):pe?r.jsxs("div",{className:w,children:[r.jsx(te,{}),r.jsx("h2",{children:"Oops! Something went wrong"}),r.jsx("p",{children:pe}),r.jsx("button",{onClick:()=>X("/home"),children:"Back to Search"})]}):0===ke.length?r.jsxs("div",{className:N,children:[r.jsx(K,{}),r.jsx("h2",{children:"No buses found"}),r.jsxs("p",{children:["No buses available from ",le," to ",oe," on ",Ne(de),". Try a different date or route."]}),r.jsx("button",{onClick:()=>X("/home"),children:"Search Again"})]}):r.jsx("div",{className:b,children:ke.map(e=>{var s,a,t,i,n,l;return e.available_seats,r.jsxs("div",{className:f,children:[r.jsxs("div",{className:L,children:[r.jsxs("div",{className:B,children:[r.jsxs("div",{className:C,children:[r.jsx("span",{className:S,children:we(e.departure_time)}),r.jsx("span",{className:M,children:le})]}),r.jsxs("div",{className:W,children:[r.jsxs("div",{className:D,children:[r.jsx("div",{className:T}),r.jsx("div",{className:P}),r.jsx(K,{}),r.jsx("div",{className:P}),r.jsx("div",{className:T})]}),r.jsx("span",{children:be(null==(s=e.routes)?void 0:s.duration_minutes)})]}),r.jsxs("div",{className:C,children:[r.jsx("span",{className:S,children:e.arrival_time?we(e.arrival_time):"~"+we(new Date(new Date(e.departure_time).getTime()+6e4*((null==(a=e.routes)?void 0:a.duration_minutes)||0)))}),r.jsx("span",{className:M,children:oe})]})]}),r.jsxs("div",{className:$,children:[r.jsx("div",{className:A,children:(null==(t=e.buses)?void 0:t.bus_name)||"Standard Bus"}),r.jsx("div",{className:H,children:(null==(i=e.buses)?void 0:i.bus_type)||"standard"}),(null==(n=e.buses)?void 0:n.amenities)&&e.buses.amenities.length>0&&r.jsx("div",{className:I,children:e.buses.amenities.filter(e=>e&&(e=>{const s=(e||"").toLowerCase().trim();return["wifi","ac","aircon","air conditioning","power","usb","charging","charging port","charging_port","charging-port"].includes(s)})(e)).map(e=>{const s=r.jsx(re,{type:e});return s?r.jsx("span",{className:E,title:e,children:s},e):null}).filter(Boolean)})]}),r.jsx("div",{className:O,children:r.jsxs("span",{className:`${R} ${e.available_seats<=5?q:""}`,children:[e.available_seats," ",1===e.available_seats?"seat":"seats"," left"]})}),r.jsxs("div",{className:F,children:[r.jsxs("div",{className:G,children:[r.jsx("span",{className:U,children:(l=e.price,`P${l}`)}),r.jsx("span",{className:V,children:"per person"})]}),r.jsxs("button",{className:Z,type:"button","data-trip-id":e.id,onClick:s=>{s.stopPropagation(),(e=>{se({id:e.id,origin:le,destination:oe,date:de,price:e.price,departure_time:e.departure_time,arrival_time:e.arrival_time,bus:e.buses,route:e.routes,available_seats:e.available_seats}),X(`/booking/seats/${e.id}?passengers=${ce}`)})(e)},disabled:e.available_seats<ce,children:["Select",r.jsx(ae,{style:{pointerEvents:"none"}})]})]})]}),e.available_seats<=5&&e.available_seats>=ce&&r.jsxs("div",{className:z,children:["⚡ Only ",e.available_seats," seats remaining - Book now!"]})]},e.id)})})})]})}export{ne as default};
