const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CHY3DGCF.js","assets/index-FXjg0z6j.css"])))=>i.map(i=>d[i]);
import{u as e,c as s,r as t,j as i,d as o,L as a,e as n,g as r,t as l,_ as c,p as d,b as h}from"./index-CHY3DGCF.js";import{validateEmail as u}from"./validation-DjNTQiWP.js";import{B as m}from"./Button-BPOJBceX.js";import{s as p}from"./Auth.module-DDhYhM2P.js";const g=()=>{const g=e(),{login:x,signInWithProvider:j}=s(),[f,v]=t.useState(""),[k,b]=t.useState(""),[y,C]=t.useState(!1),[w,L]=t.useState(!1),[N,S]=t.useState(""),[I,B]=t.useState(!1),[M,O]=t.useState(null),[T,P]=t.useState(!1),[W,A]=t.useState(!1);t.useEffect(()=>{const e=setTimeout(()=>B(!0),100);return()=>clearTimeout(e)},[]),t.useEffect(()=>{const e=localStorage.getItem("gogobus_remembered_email");e&&(v(e),P(!0))},[]);const D=async e=>{try{await j(e)}catch(s){S(`${e} login failed. Please try again.`)}},E=f&&u(f),_=k.length>=6;return i.jsxs("div",{className:p.authScreen,children:[i.jsxs("div",{className:p.authHero,children:[i.jsx("div",{className:p.heroBackground,style:{backgroundImage:"url(https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=1200&q=80)"},children:i.jsx("div",{className:p.heroOverlay})}),i.jsxs("div",{className:p.heroContent,children:[i.jsx("button",{className:p.backBtn,onClick:()=>g("/get-started"),"aria-label":"Go back",children:i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),i.jsxs("div",{className:p.heroLogo,children:[i.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{x:"4",y:"10",width:"32",height:"20",rx:"5",fill:"#F5A623"}),i.jsx("rect",{x:"7",y:"13",width:"8",height:"6",rx:"1.5",fill:"#1B4D4A"}),i.jsx("rect",{x:"17",y:"13",width:"8",height:"6",rx:"1.5",fill:"#1B4D4A"}),i.jsx("circle",{cx:"12",cy:"30",r:"4",fill:"#333"}),i.jsx("circle",{cx:"28",cy:"30",r:"4",fill:"#333"})]}),i.jsx("span",{children:"GOGOBUS"})]}),i.jsxs("div",{className:p.heroText,children:[i.jsx("h1",{children:"Welcome Back!"}),i.jsx("p",{children:"Sign in to continue your journey"})]})]})]}),i.jsxs("div",{className:`${p.authContainer} ${I?p.loaded:""} ${W?p.success:""}`,children:[W&&i.jsxs("div",{className:p.successOverlay,children:[i.jsx("div",{className:p.successIcon,children:i.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#22C55E"}),i.jsx("path",{d:"M8 12L11 15L16 9",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),i.jsx("span",{children:"Welcome aboard!"})]}),i.jsxs("form",{onSubmit:async e=>{var s;if(e.preventDefault(),S(""),!u(f))return void S("Please enter a valid email address");if(n(f).limited){const e=r(f);return void S(`Too many failed login attempts. Please try again in ${e} minute(s).`)}if(k.length<6)S("Password must be at least 6 characters");else{L(!0);try{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:63",message:"Login attempt started",data:{email:f},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{}),await x(f,k),fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:66",message:"Login successful, starting admin check",data:{email:f},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{}),l("email"),T?localStorage.setItem("gogobus_remembered_email",f):localStorage.removeItem("gogobus_remembered_email"),A(!0),setTimeout(async()=>{try{fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:81",message:"Admin check timeout started",data:{email:f,timeoutMs:1200},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{});const{authService:e}=await c(async()=>{const{authService:e}=await import("./index-CHY3DGCF.js").then(e=>e.D);return{authService:e}},__vite__mapDeps([0,1])),s=await e.getUser();if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:85",message:"Auth user retrieved",data:{userId:null==s?void 0:s.id,email:null==s?void 0:s.email,hasId:!!(null==s?void 0:s.id)},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{}),null==s?void 0:s.id){const e=await d.getProfile(s.id);if(fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:88",message:"Profile retrieved in Login",data:{profileExists:!!e,role:null==e?void 0:e.role,isAdmin:"admin"===(null==e?void 0:e.role),profileData:e?{id:e.id,email:e.email,role:e.role}:null},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),"admin"===(null==e?void 0:e.role))return fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:91",message:"Admin role detected, navigating to /admin",data:{email:f,role:e.role},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),void g("/admin",{replace:!0});fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:95",message:"Not admin, navigating to /home",data:{email:f,role:(null==e?void 0:e.role)||"null"},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{})}else fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:99",message:"No auth user ID, navigating to /home",data:{email:f},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{})}catch(e){fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:103",message:"Error checking admin status",data:{email:f,error:e.message,errorStack:e.stack},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch(()=>{}),h("Error checking admin status",e)}fetch("http://127.0.0.1:7244/ingest/c4c33fba-1ee4-4b2f-aa1a-ed506c7c702f",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"Login.jsx:106",message:"Fallback navigation to /home",data:{email:f},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"D"})}).catch(()=>{}),g("/home",{replace:!0})},1200)}catch(t){let e="Login failed. Please check your credentials.";const i=t.status||t.code,o=(null==(s=t.message)?void 0:s.toLowerCase())||"";400===i||o.includes("email not confirmed")||o.includes("not confirmed")?e="Please verify your email address before logging in.":401===i||o.includes("invalid")||o.includes("invalid_credentials")?e="Invalid email or password.":t.message&&(e=t.message),S(e)}finally{L(!1)}}},className:p.authForm,children:[N&&i.jsxs("div",{className:p.errorMessage,children:[i.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),i.jsx("path",{d:"M12 8V12M12 16H12.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),N]}),i.jsxs("div",{className:`${p.inputGroup} ${"email"===M?p.focused:""} ${E?p.valid:""}`,children:[i.jsxs("label",{className:p.inputLabel,children:[i.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"3",stroke:"currentColor",strokeWidth:"2"}),i.jsx("path",{d:"M2 7L12 13L22 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),"Email Address"]}),i.jsxs("div",{className:p.inputWrapper,children:[i.jsx("input",{type:"email",value:f,onChange:e=>v(e.target.value),onFocus:()=>O("email"),onBlur:()=>O(null),placeholder:"yourname@example.com",required:!0,className:p.input,autoComplete:"email"}),E&&i.jsx("div",{className:p.validIcon,children:i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M20 6L9 17L4 12",stroke:"#22C55E",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),i.jsxs("div",{className:`${p.inputGroup} ${"password"===M?p.focused:""} ${_?p.valid:""}`,children:[i.jsxs("label",{className:p.inputLabel,children:[i.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",stroke:"currentColor",strokeWidth:"2"}),i.jsx("path",{d:"M7 11V7C7 4.23858 9.23858 2 12 2C14.7614 2 17 4.23858 17 7V11",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("circle",{cx:"12",cy:"16",r:"1.5",fill:"currentColor"})]}),"Password"]}),i.jsxs("div",{className:p.inputWrapper,children:[i.jsx("input",{type:y?"text":"password",value:k,onChange:e=>b(e.target.value),onFocus:()=>O("password"),onBlur:()=>O(null),placeholder:"Enter your password",required:!0,className:p.input,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:p.togglePassword,onClick:()=>C(!y),"aria-label":y?"Hide password":"Show password",children:y?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20C7 20 2.73 16.11 1 12C1.69 10.24 2.78 8.69 4.19 7.46M9.88 9.88A3 3 0 0014.12 14.12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),i.jsx("path",{d:"M1 1L23 23",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("path",{d:"M6.34 6.34C8.06 5.13 10.02 4.5 12 4.5C17 4.5 21.27 8.39 23 12.5C22.29 14.31 21.16 15.91 19.73 17.16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("path",{d:"M1 12C2.73 7.61 7 4 12 4C17 4 21.27 7.61 23 12C21.27 16.39 17 20 12 20C7 20 2.73 16.39 1 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),i.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"})]})}),_&&i.jsx("div",{className:p.validIcon,style:{right:"48px"},children:i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M20 6L9 17L4 12",stroke:"#22C55E",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),i.jsxs("div",{className:p.formOptions,children:[i.jsxs("label",{className:p.rememberMe,children:[i.jsx("input",{type:"checkbox",checked:T,onChange:e=>P(e.target.checked)}),i.jsx("span",{className:p.checkmark,children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M20 6L9 17L4 12",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}),"Remember me"]}),i.jsx(o,{to:"/reset-password",className:p.forgotPassword,children:"Forgot Password?"})]}),i.jsx(m,{type:"submit",disabled:w||W,className:p.submitButton,children:w?i.jsxs("span",{className:p.loadingState,children:[i.jsx(a,{size:"small"}),i.jsx("span",{children:"Signing in..."})]}):i.jsxs("span",{className:p.buttonContent,children:[i.jsx("span",{children:"Sign In"}),i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M5 12H19M19 12L12 5M19 12L12 19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]}),i.jsxs("div",{className:p.divider,children:[i.jsx("div",{className:p.dividerLine}),i.jsx("span",{children:"or continue with"}),i.jsx("div",{className:p.dividerLine})]}),i.jsxs("div",{className:p.socialLoginButtons,children:[i.jsxs("button",{type:"button",className:p.socialBtn,"aria-label":"Login with Google",onClick:()=>D("google"),children:[i.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",children:[i.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),i.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),i.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),i.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),i.jsx("span",{children:"Google"})]}),i.jsxs("button",{type:"button",className:p.socialBtn,"aria-label":"Login with Facebook",onClick:()=>D("facebook"),children:[i.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"#1877F2",children:i.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),i.jsx("span",{children:"Facebook"})]}),i.jsxs("button",{type:"button",className:p.socialBtn,"aria-label":"Login with Apple",onClick:()=>D("apple"),children:[i.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M18.71 19.5C17.88 20.74 17 21.95 15.66 21.97C14.32 22 13.89 21.18 12.37 21.18C10.84 21.18 10.37 21.95 9.09997 22C7.78997 22.05 6.79997 20.68 5.95997 19.47C4.24997 17 2.93997 12.45 4.69997 9.39C5.56997 7.87 7.12997 6.91 8.81997 6.88C10.1 6.86 11.32 7.75 12.11 7.75C12.89 7.75 14.37 6.68 15.92 6.84C16.57 6.87 18.39 7.1 19.56 8.82C19.47 8.88 17.39 10.1 17.41 12.63C17.44 15.65 20.06 16.66 20.09 16.67C20.06 16.74 19.67 18.11 18.71 19.5ZM13 3.5C13.73 2.67 14.94 2.04 15.94 2C16.07 3.17 15.6 4.35 14.9 5.19C14.21 6.04 13.07 6.7 11.95 6.61C11.8 5.46 12.36 4.26 13 3.5Z"})}),i.jsx("span",{children:"Apple"})]})]}),i.jsx("div",{className:p.authFooter,children:i.jsxs("p",{children:["Don't have an account? ",i.jsx(o,{to:"/signup",children:"Create Account"})]})}),i.jsxs("div",{className:p.securityBadge,children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("path",{d:"M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),i.jsx("path",{d:"M9 12L11 14L15 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),i.jsx("span",{children:"Secured with 256-bit encryption"})]})]})]})};export{g as default};
