const e=e=>{if(!e||"string"!=typeof e)return!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())},t=e=>{if(!e||"string"!=typeof e)return!1;return/^\+267\d{8}$/.test(e.trim())},r=(e,t={})=>{const{minLength:r=2,maxLength:s=100}=t;if(!e||"string"!=typeof e)return!1;const n=e.trim();if(n.length<r||n.length>s)return!1;return/^[a-zA-Z\s\-'\.]+$/.test(n)},s=(e,t={})=>{const{min:r=.01,max:s=1e5}=t,n="string"==typeof e?parseFloat(e):e;return!(isNaN(n)||!isFinite(n))&&(n>=r&&n<=s)},n=(e,t={})=>{const{allowPast:r=!1,maxDaysFuture:s=365}=t;if(!e)return!1;const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return!1;const a=new Date;if(a.setHours(0,0,0,0),n.setHours(0,0,0,0),!r&&n<a)return!1;const i=new Date(a);return i.setDate(i.getDate()+s),!(n>i)},a=(e,t=10)=>{if(!e)return!1;const r=Array.isArray(e)?e:[e];if(0===r.length||r.length>t)return!1;const s=/^\d+[A-Z]$/i;return r.every(e=>"string"==typeof e&&s.test(e.trim()))},i=e=>{if(!e||"string"!=typeof e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return e.replace(/[&<>"'/]/g,e=>t[e])},u=e=>{if(null==e)return e;if("string"==typeof e)return i(e);if(Array.isArray(e))return e.map(e=>u(e));if("object"==typeof e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=u(e[r]));return t}return e},o=n=>{const i=[];return n.schedule_id||i.push("Schedule ID is required"),n.seats&&Array.isArray(n.seats)&&0!==n.seats.length?a(n.seats)||i.push("Invalid seat selection format"):i.push("At least one seat must be selected"),n.passenger_name&&r(n.passenger_name)||i.push("Valid passenger name is required"),n.passenger_email&&e(n.passenger_email)||i.push("Valid passenger email is required"),n.passenger_phone&&t(n.passenger_phone)||i.push("Valid passenger phone number is required (format: +267XXXXXXXX)"),n.total_price&&!s(n.total_price)&&i.push("Invalid payment amount"),{valid:0===i.length,errors:i}},p=e=>{if(!e||"string"!=typeof e)return!1;return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.trim())};export{i as sanitizeInput,u as sanitizeObject,s as validateAmount,o as validateBookingInput,n as validateDate,e as validateEmail,r as validateName,t as validatePhone,a as validateSeats,p as validateUUID};
