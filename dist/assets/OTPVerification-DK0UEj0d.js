import{u as e,h as a,c as s,r as t,j as i,L as l}from"./index-BKhXCF24.js";import{B as n}from"./Button-DBYBD_di.js";import{I as r}from"./Input-BGZUHMOC.js";import{s as c}from"./Auth.module-DDhYhM2P.js";const o=()=>{var o;const d=e(),h=a(),{verifyOTP:m,sendOTP:u}=s(),[p,j]=t.useState((null==(o=h.state)?void 0:o.email)||""),[f,x]=t.useState(""),[g,v]=t.useState(!1),[y,b]=t.useState(!1),[k,N]=t.useState("");t.useEffect(()=>{const e=new URLSearchParams(window.location.hash.substring(1)),a=e.get("access_token"),s=e.get("type");a&&"email"===s&&(window.location.hash="",d("/home",{replace:!0}))},[d]);return i.jsx("div",{className:c.authScreen,children:i.jsxs("div",{className:c.authContainer,children:[i.jsxs("div",{className:c.authHeader,children:[i.jsx("button",{className:c.backBtn,onClick:()=>d("/signup"),"aria-label":"Go back",children:i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:i.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),i.jsx("h1",{className:c.authTitle,children:"Verify Email"}),i.jsx("div",{className:c.headerSpacer})]}),i.jsxs("div",{className:c.otpInfo,children:[i.jsx("p",{children:"We've sent a verification code to:"}),i.jsx("p",{className:c.emailDisplay,children:p||"your email"}),i.jsx("p",{className:c.otpInstructions,children:"Please check your email and enter the 6-digit code below, or click the magic link in the email."})]}),i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),N(""),f.length<6)N("Please enter the 6-digit code");else{v(!0);try{await m(p,f),d("/complete-profile")}catch(a){N(a.message||"Invalid verification code. Please try again.")}finally{v(!1)}}},className:c.authForm,children:[k&&i.jsx("div",{className:c.errorMessage,children:k}),i.jsx(r,{type:"text",label:"Verification Code",value:f,onChange:e=>x(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",required:!0,maxLength:6}),i.jsx(n,{type:"submit",disabled:g||6!==f.length,className:c.submitButton,children:g?i.jsx(l,{size:"small"}):"Verify"}),i.jsx("button",{type:"button",onClick:async()=>{if(p){b(!0);try{await u(p),N(""),alert("Verification code sent! Please check your email.")}catch(e){N(e.message||"Failed to resend code. Please try again.")}finally{b(!1)}}else N("Email is required to resend code")},disabled:y,className:c.resendButton,children:y?"Sending...":"Didn't receive code? Resend"})]})]})})};export{o as default};
